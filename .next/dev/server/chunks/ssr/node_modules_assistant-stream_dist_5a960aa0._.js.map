{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/AssistantStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/AssistantStream.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"./AssistantStreamChunk\";\n\nexport type AssistantStream = ReadableStream<AssistantStreamChunk>;\n\nexport type AssistantStreamEncoder = ReadableWritablePair<\n  Uint8Array<ArrayBuffer>,\n  AssistantStreamChunk\n> & {\n  headers?: Headers;\n};\n\nexport const AssistantStream = {\n  toResponse(stream: AssistantStream, transformer: AssistantStreamEncoder) {\n    return new Response(AssistantStream.toByteStream(stream, transformer), {\n      headers: transformer.headers ?? {},\n    });\n  },\n\n  fromResponse(\n    response: Response,\n    transformer: ReadableWritablePair<\n      AssistantStreamChunk,\n      Uint8Array<ArrayBuffer>\n    >,\n  ) {\n    return AssistantStream.fromByteStream(response.body!, transformer);\n  },\n\n  toByteStream(\n    stream: AssistantStream,\n    transformer: ReadableWritablePair<\n      Uint8Array<ArrayBuffer>,\n      AssistantStreamChunk\n    >,\n  ) {\n    return stream.pipeThrough(transformer);\n  },\n\n  fromByteStream(\n    readable: ReadableStream<Uint8Array<ArrayBuffer>>,\n    transformer: ReadableWritablePair<\n      AssistantStreamChunk,\n      Uint8Array<ArrayBuffer>\n    >,\n  ) {\n    return readable.pipeThrough(transformer);\n  },\n};\n"],"names":[],"mappings":";;;;AAWO,MAAM,eAAe,GAAG;IAC7B,UAAU,EAAC,MAAuB,EAAE,WAAmC;QACrE,OAAO,IAAI,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC,MAAM,EAAE,WAAW,CAAC,EAAE;YACrE,OAAO,EAAE,WAAW,CAAC,OAAO,IAAI,CAAA,CAAE;SACnC,CAAC,CAAC;IACL,CAAC;IAED,YAAY,EACV,QAAkB,EAClB,WAGC;QAED,OAAO,eAAe,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAK,EAAE,WAAW,CAAC,CAAC;IACrE,CAAC;IAED,YAAY,EACV,MAAuB,EACvB,WAGC;QAED,OAAO,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;IACzC,CAAC;IAED,cAAc,EACZ,QAAiD,EACjD,WAGC;QAED,OAAO,QAAQ,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;IAC3C,CAAC;CACF,CAAC"}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/utils/promiseWithResolvers.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/utils/promiseWithResolvers.ts"],"sourcesContent":["export const promiseWithResolvers = function <T>() {\n  let resolve: ((value: T | PromiseLike<T>) => void) | undefined;\n  let reject: ((reason?: unknown) => void) | undefined;\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  if (!resolve || !reject) throw new Error(\"Failed to create promise\");\n  return { promise, resolve, reject };\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,oBAAoB,GAAG;IAClC,IAAI,OAA0D,CAAC;IAC/D,IAAI,MAAgD,CAAC;IACrD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAI,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QAC1C,OAAO,GAAG,GAAG,CAAC;QACd,MAAM,GAAG,GAAG,CAAC;IACf,CAAC,CAAC,CAAC;IACH,IAAI,CAAC,OAAO,IAAI,CAAC,MAAM,EAAE,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;IACrE,OAAO;QAAE,OAAO;QAAE,OAAO;QAAE,MAAM;IAAA,CAAE,CAAC;AACtC,CAAC,CAAC"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/merge.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/merge.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"../../AssistantStreamChunk\";\nimport { promiseWithResolvers } from \"../../../utils/promiseWithResolvers\";\n\ntype MergeStreamItem = {\n  reader: ReadableStreamDefaultReader<AssistantStreamChunk>;\n  promise?: Promise<unknown> | undefined;\n};\n\nexport const createMergeStream = () => {\n  const list: MergeStreamItem[] = [];\n  let sealed = false;\n  let controller: ReadableStreamDefaultController<AssistantStreamChunk>;\n  let currentPull: ReturnType<typeof promiseWithResolvers<void>> | undefined;\n\n  const handlePull = (item: MergeStreamItem) => {\n    if (!item.promise) {\n      // TODO for most streams, we can directly pipeTo to avoid the microTask queue\n      // add an option to eagerly pipe the stream to the merge stream\n      // ideally, using assistant-stream w sync run method + piping to a sync WritableStream runs in the same microtask\n      // this is useful because we often use AssistantStreams internally as a serialization utility, e. g. AssistantTransformStream\n      // idea: avoid reader.read() by instead using a WritableStream & if (!hasPendingPull) await waitForPull()?\n      item.promise = item.reader\n        .read()\n        .then(({ done, value }) => {\n          item.promise = undefined;\n          if (done) {\n            list.splice(list.indexOf(item), 1);\n            if (sealed && list.length === 0) {\n              controller.close();\n            }\n          } else {\n            controller.enqueue(value);\n          }\n\n          currentPull?.resolve();\n          currentPull = undefined;\n        })\n        .catch((e) => {\n          console.error(e);\n\n          list.forEach((item) => {\n            item.reader.cancel();\n          });\n          list.length = 0;\n\n          controller.error(e);\n\n          currentPull?.reject(e);\n          currentPull = undefined;\n        });\n    }\n  };\n\n  const readable = new ReadableStream<AssistantStreamChunk>({\n    start(c) {\n      controller = c;\n    },\n    pull() {\n      currentPull = promiseWithResolvers();\n      list.forEach((item) => {\n        handlePull(item);\n      });\n\n      return currentPull.promise;\n    },\n    cancel() {\n      list.forEach((item) => {\n        item.reader.cancel();\n      });\n      list.length = 0;\n    },\n  });\n\n  return {\n    readable,\n    isSealed() {\n      return sealed;\n    },\n    seal() {\n      sealed = true;\n      if (list.length === 0) controller.close();\n    },\n    addStream(stream: ReadableStream<AssistantStreamChunk>) {\n      if (sealed)\n        throw new Error(\n          \"Cannot add streams after the run callback has settled.\",\n        );\n\n      const item = { reader: stream.getReader() };\n      list.push(item);\n      handlePull(item);\n    },\n    enqueue(chunk: AssistantStreamChunk) {\n      this.addStream(\n        new ReadableStream({\n          start(c) {\n            c.enqueue(chunk);\n            c.close();\n          },\n        }),\n      );\n    },\n  };\n};\n\n// TODO\n// export class SpanContainerMerger {\n//   public get isSealed() {\n//     return this.mergeStream.isSealed();\n//   }\n\n//   public get readable() {\n//     return this.mergeStream.readable;\n//   }\n\n//   private subAllocator = new Counter();\n//   private mergeStream = createMergeStream();\n\n//   constructor() {\n//     // id 0 is auto allocated\n//     this.subAllocator.up();\n//   }\n\n//   add(stream: ReadableStream<AssistantStreamChunk>) {\n//     this.mergeStream.addStream(\n//       stream.pipeThrough(new SpanParentEncoder(this.subAllocator)),\n//     );\n//   }\n\n//   enqueue(chunk: AssistantStreamChunk & { parentId: 0 }) {\n//     this.mergeStream.addStream(\n//       new ReadableStream({\n//         start(c) {\n//           c.enqueue(chunk);\n//           c.close();\n//         },\n//       }),\n//     );\n//   }\n\n//   seal() {\n//     this.mergeStream.seal();\n//   }\n// }\n\n// export class SpanContainerSplitter {\n//   public writable;\n\n//   private isSealed = false;\n//   private writers = new Map<\n//     number,\n//     WritableStreamDefaultWriter<AssistantStreamChunk>\n//   >();\n\n//   private closeTasks: Promise<void>[] = [];\n\n//   private allocator = new Counter();\n//   private subAllocator = new Counter();\n\n//   constructor() {\n//     // id 0 is auto-allocated\n//     this.allocator.up();\n\n//     this.writable = new WritableStream({\n//       write: (chunk) => {\n//         const { type, parentId } = chunk;\n\n//         const writer = this.writers.get(parentId);\n//         if (writer === undefined) throw new Error(\"Parent id not found\");\n\n//         writer.write(chunk);\n\n//         if (type === \"span\") {\n//           // allocate a new span id\n//           this.writers.set(this.allocator.up(), writer);\n//         }\n//         if (type === \"finish\") {\n//           this.writers.delete(parentId);\n//           writer.close();\n\n//           if (this.writers.size === 0) {\n//             const closeTask = this.writable.close();\n//             this.closeTasks.push(closeTask);\n//             closeTask.then(() => {\n//               this.closeTasks.splice(this.closeTasks.indexOf(closeTask), 1);\n//             });\n//           }\n//         }\n//       },\n//       close: async () => {\n//         if (this.writers.size > 0) throw new Error(\"Not all writers closed\");\n\n//         // await and throw on any errors\n//         await Promise.all(this.closeTasks);\n//       },\n//     });\n//   }\n\n//   add(stream: WritableStream<AssistantStreamChunk>) {\n//     if (this.isSealed) throw new Error(\"Cannot add streams after sealing\");\n\n//     const decoder = new SpanParentDecoder(this.subAllocator);\n//     decoder.readable.pipeTo(stream);\n\n//     this.writers.set(this.allocator.up(), decoder.writable.getWriter());\n//   }\n\n//   seal() {\n//     this.isSealed = true;\n//     if (this.writers.size === 0) this.writable.close();\n//   }\n// }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/modules/text.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/modules/text.ts"],"sourcesContent":["import { AssistantStream } from \"../AssistantStream\";\nimport { AssistantStreamChunk } from \"../AssistantStreamChunk\";\nimport { UnderlyingReadable } from \"../utils/stream/UnderlyingReadable\";\n\nexport type TextStreamController = {\n  append(textDelta: string): void;\n  close(): void; // TODO reason? error?\n};\n\nclass TextStreamControllerImpl implements TextStreamController {\n  private _controller: ReadableStreamDefaultController<AssistantStreamChunk>;\n  private _isClosed = false;\n\n  constructor(\n    controller: ReadableStreamDefaultController<AssistantStreamChunk>,\n  ) {\n    this._controller = controller;\n  }\n\n  append(textDelta: string) {\n    this._controller.enqueue({\n      type: \"text-delta\",\n      path: [],\n      textDelta,\n    });\n    return this;\n  }\n\n  close() {\n    if (this._isClosed) return;\n    this._isClosed = true;\n    this._controller.enqueue({\n      type: \"part-finish\",\n      path: [],\n    });\n    this._controller.close();\n  }\n}\n\nexport const createTextStream = (\n  readable: UnderlyingReadable<TextStreamController>,\n): AssistantStream => {\n  return new ReadableStream({\n    start(c) {\n      return readable.start?.(new TextStreamControllerImpl(c));\n    },\n    pull(c) {\n      return readable.pull?.(new TextStreamControllerImpl(c));\n    },\n    cancel(c) {\n      return readable.cancel?.(c);\n    },\n  });\n};\n\nexport const createTextStreamController = () => {\n  let controller!: TextStreamController;\n  const stream = createTextStream({\n    start(c) {\n      controller = c;\n    },\n  });\n  return [stream, controller] as const;\n};\n"],"names":[],"mappings":";;;;;;AASA,MAAM,wBAAwB;IACpB,WAAW,CAAwD;IACnE,SAAS,GAAG,KAAK,CAAC;IAE1B,YACE,UAAiE,CAAA;QAEjE,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;IAChC,CAAC;IAED,MAAM,CAAC,SAAiB,EAAA;QACtB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;YACvB,IAAI,EAAE,YAAY;YAClB,IAAI,EAAE,EAAE;YACR,SAAS;SACV,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,GAAA;QACH,IAAI,IAAI,CAAC,SAAS,EAAE,OAAO;QAC3B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;YACvB,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,EAAE;SACT,CAAC,CAAC;QACH,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;IAC3B,CAAC;CACF;AAEM,MAAM,gBAAgB,GAAG,CAC9B,QAAkD,EACjC,EAAE;IACnB,OAAO,IAAI,cAAc,CAAC;QACxB,KAAK,EAAC,CAAC;YACL,OAAO,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,wBAAwB,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3D,CAAC;QACD,IAAI,EAAC,CAAC;YACJ,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC,IAAI,wBAAwB,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1D,CAAC;QACD,MAAM,EAAC,CAAC;YACN,OAAO,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC;KACF,CAAC,CAAC;AACL,CAAC,CAAC;AAEK,MAAM,0BAA0B,GAAG,GAAG,EAAE;IAC7C,IAAI,UAAiC,CAAC;IACtC,MAAM,MAAM,GAAG,gBAAgB,CAAC;QAC9B,KAAK,EAAC,CAAC;YACL,UAAU,GAAG,CAAC,CAAC;QACjB,CAAC;KACF,CAAC,CAAC;IACH,OAAO;QAAC,MAAM;QAAE,UAAU;KAAU,CAAC;AACvC,CAAC,CAAC"}},
    {"offset": {"line": 286, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/modules/tool-call.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/modules/tool-call.ts"],"sourcesContent":["import { AssistantStream } from \"../AssistantStream\";\nimport { AssistantStreamChunk } from \"../AssistantStreamChunk\";\nimport { ToolResponseLike } from \"../tool/ToolResponse\";\nimport { ReadonlyJSONValue } from \"../../utils/json/json-value\";\nimport { UnderlyingReadable } from \"../utils/stream/UnderlyingReadable\";\nimport { createTextStream, TextStreamController } from \"./text\";\n\nexport type ToolCallStreamController = {\n  argsText: TextStreamController;\n\n  setResponse(response: ToolResponseLike<ReadonlyJSONValue>): void;\n  close(): void;\n};\n\nclass ToolCallStreamControllerImpl implements ToolCallStreamController {\n  private _isClosed = false;\n\n  private _mergeTask: Promise<void>;\n  constructor(\n    private _controller: ReadableStreamDefaultController<AssistantStreamChunk>,\n  ) {\n    const stream = createTextStream({\n      start: (c) => {\n        this._argsTextController = c;\n      },\n    });\n\n    let hasArgsText = false;\n    this._mergeTask = stream.pipeTo(\n      new WritableStream({\n        write: (chunk) => {\n          switch (chunk.type) {\n            case \"text-delta\":\n              hasArgsText = true;\n              this._controller.enqueue(chunk);\n              break;\n\n            case \"part-finish\":\n              if (!hasArgsText) {\n                // if no argsText was provided, assume empty object\n                this._controller.enqueue({\n                  type: \"text-delta\",\n                  textDelta: \"{}\",\n                  path: [],\n                });\n              }\n              this._controller.enqueue({\n                type: \"tool-call-args-text-finish\",\n                path: [],\n              });\n              break;\n\n            default:\n              throw new Error(`Unexpected chunk type: ${chunk.type}`);\n          }\n        },\n      }),\n    );\n  }\n\n  get argsText() {\n    return this._argsTextController;\n  }\n\n  private _argsTextController!: TextStreamController;\n\n  async setResponse(response: ToolResponseLike<ReadonlyJSONValue>) {\n    this._argsTextController.close();\n    await Promise.resolve(); // flush microtask queue\n    // TODO switch argsTextController to be something that doesn'#t require this\n    this._controller.enqueue({\n      type: \"result\",\n      path: [],\n      ...(response.artifact !== undefined\n        ? { artifact: response.artifact }\n        : {}),\n      result: response.result,\n      isError: response.isError ?? false,\n    });\n  }\n\n  async close() {\n    if (this._isClosed) return;\n\n    this._isClosed = true;\n    this._argsTextController.close();\n    await this._mergeTask;\n\n    this._controller.enqueue({\n      type: \"part-finish\",\n      path: [],\n    });\n    this._controller.close();\n  }\n}\n\nexport const createToolCallStream = (\n  readable: UnderlyingReadable<ToolCallStreamController>,\n): AssistantStream => {\n  return new ReadableStream({\n    start(c) {\n      return readable.start?.(new ToolCallStreamControllerImpl(c));\n    },\n    pull(c) {\n      return readable.pull?.(new ToolCallStreamControllerImpl(c));\n    },\n    cancel(c) {\n      return readable.cancel?.(c);\n    },\n  });\n};\n\nexport const createToolCallStreamController = () => {\n  let controller!: ToolCallStreamController;\n  const stream = createToolCallStream({\n    start(c) {\n      controller = c;\n    },\n  });\n  return [stream, controller] as const;\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/Counter.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/Counter.ts"],"sourcesContent":["export class Counter {\n  public value = -1;\n\n  up() {\n    return ++this.value;\n  }\n}\n"],"names":[],"mappings":";;;;AAAM,MAAO,OAAO;IACX,KAAK,GAAG,CAAC,CAAC,CAAC;IAElB,EAAE,GAAA;QACA,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;CACF"}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/path-utils.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/path-utils.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"../../AssistantStreamChunk\";\nimport { Counter } from \"../Counter\";\n\nexport class PathAppendEncoder extends TransformStream<\n  AssistantStreamChunk,\n  AssistantStreamChunk\n> {\n  constructor(idx: number) {\n    super({\n      transform(chunk, controller) {\n        controller.enqueue({\n          ...chunk,\n          path: [idx, ...chunk.path],\n        });\n      },\n    });\n  }\n}\n\nexport class PathAppendDecoder extends TransformStream<\n  AssistantStreamChunk,\n  AssistantStreamChunk\n> {\n  constructor(idx: number) {\n    super({\n      transform(chunk, controller) {\n        const {\n          path: [idx2, ...path],\n        } = chunk;\n\n        if (idx !== idx2)\n          throw new Error(`Path mismatch: expected ${idx}, got ${idx2}`);\n\n        controller.enqueue({\n          ...chunk,\n          path,\n        });\n      },\n    });\n  }\n}\n\nexport class PathMergeEncoder extends TransformStream<\n  AssistantStreamChunk,\n  AssistantStreamChunk\n> {\n  constructor(counter: Counter) {\n    const innerCounter = new Counter();\n    const mapping = new Map<number, number>();\n    super({\n      transform(chunk, controller) {\n        if (chunk.type === \"part-start\" && chunk.path.length === 0) {\n          mapping.set(innerCounter.up(), counter.up());\n        }\n\n        const [idx, ...path] = chunk.path;\n        if (idx === undefined) {\n          controller.enqueue(chunk);\n          return;\n        }\n        const mappedIdx = mapping.get(idx);\n        if (mappedIdx === undefined) throw new Error(\"Path not found\");\n\n        controller.enqueue({\n          ...chunk,\n          path: [mappedIdx, ...path],\n        });\n      },\n    });\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AACA,OAAO,EAAE,OAAO,EAAE,sBAAmB;;AAE/B,MAAO,iBAAkB,SAAQ,eAGtC;IACC,YAAY,GAAW,CAAA;QACrB,KAAK,CAAC;YACJ,SAAS,EAAC,KAAK,EAAE,UAAU;gBACzB,UAAU,CAAC,OAAO,CAAC;oBACjB,GAAG,KAAK;oBACR,IAAI,EAAE;wBAAC,GAAG,EAAE;2BAAG,KAAK,CAAC,IAAI;qBAAC;iBAC3B,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF;AAEK,MAAO,iBAAkB,SAAQ,eAGtC;IACC,YAAY,GAAW,CAAA;QACrB,KAAK,CAAC;YACJ,SAAS,EAAC,KAAK,EAAE,UAAU;gBACzB,MAAM,EACJ,IAAI,EAAE,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,EACtB,GAAG,KAAK,CAAC;gBAEV,IAAI,GAAG,KAAK,IAAI,EACd,MAAM,IAAI,KAAK,CAAC,CAAA,wBAAA,EAA2B,GAAG,CAAA,MAAA,EAAS,IAAI,EAAE,CAAC,CAAC;gBAEjE,UAAU,CAAC,OAAO,CAAC;oBACjB,GAAG,KAAK;oBACR,IAAI;iBACL,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF;AAEK,MAAO,gBAAiB,SAAQ,eAGrC;IACC,YAAY,OAAgB,CAAA;QAC1B,MAAM,YAAY,GAAG,IAAI,kLAAO,EAAE,CAAC;QACnC,MAAM,OAAO,GAAG,IAAI,GAAG,EAAkB,CAAC;QAC1C,KAAK,CAAC;YACJ,SAAS,EAAC,KAAK,EAAE,UAAU;gBACzB,IAAI,KAAK,CAAC,IAAI,KAAK,YAAY,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBAC3D,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;gBAC/C,CAAC;gBAED,MAAM,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC;gBAClC,IAAI,GAAG,KAAK,SAAS,EAAE,CAAC;oBACtB,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;oBAC1B,OAAO;gBACT,CAAC;gBACD,MAAM,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBACnC,IAAI,SAAS,KAAK,SAAS,EAAE,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;gBAE/D,UAAU,CAAC,OAAO,CAAC;oBACjB,GAAG,KAAK;oBACR,IAAI,EAAE;wBAAC,SAAS,EAAE;2BAAG,IAAI;qBAAC;iBAC3B,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 476, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/PipeableTransformStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/PipeableTransformStream.ts"],"sourcesContent":["export class PipeableTransformStream<I, O> extends TransformStream<I, O> {\n  constructor(transform: (readable: ReadableStream<I>) => ReadableStream<O>) {\n    super();\n    const readable = transform(super.readable as unknown as ReadableStream<I>);\n    Object.defineProperty(this, \"readable\", {\n      value: readable,\n      writable: false,\n    });\n  }\n}\n"],"names":[],"mappings":";;;;AAAM,MAAO,uBAA8B,SAAQ,eAAqB;IACtE,YAAY,SAA6D,CAAA;QACvE,KAAK,EAAE,CAAC;QACR,MAAM,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,QAAwC,CAAC,CAAC;QAC3E,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,UAAU,EAAE;YACtC,KAAK,EAAE,QAAQ;YACf,QAAQ,EAAE,KAAK;SAChB,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 494, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/serialization/data-stream/chunk-types.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/serialization/data-stream/chunk-types.ts"],"sourcesContent":["import {\n  ReadonlyJSONObject,\n  ReadonlyJSONValue,\n} from \"../../../utils/json/json-value\";\nimport { ObjectStreamOperation } from \"../../object/types\";\n\nexport type DataStreamChunk = {\n  [K in DataStreamStreamChunkType]: {\n    type: K;\n    value: DataStreamStreamChunkValue[K];\n  };\n}[DataStreamStreamChunkType];\n\ntype LanguageModelV1FinishReason =\n  | \"stop\"\n  | \"length\"\n  | \"content-filter\"\n  | \"tool-calls\"\n  | \"error\"\n  | \"other\"\n  | \"unknown\";\n\ntype LanguageModelV1Usage = {\n  promptTokens: number;\n  completionTokens: number;\n};\n\nexport enum DataStreamStreamChunkType {\n  TextDelta = \"0\",\n  Data = \"2\",\n  Error = \"3\",\n  Annotation = \"8\",\n  ToolCall = \"9\",\n  ToolCallResult = \"a\",\n  StartToolCall = \"b\",\n  ToolCallArgsTextDelta = \"c\",\n  FinishMessage = \"d\",\n  FinishStep = \"e\",\n  StartStep = \"f\",\n  ReasoningDelta = \"g\",\n  Source = \"h\",\n  RedactedReasoning = \"i\",\n  ReasoningSignature = \"j\",\n  File = \"k\",\n\n  AuiUpdateStateOperations = \"aui-state\",\n  AuiTextDelta = \"aui-text-delta\",\n  AuiReasoningDelta = \"aui-reasoning-delta\",\n}\ntype DataStreamStreamChunkValue = {\n  [DataStreamStreamChunkType.TextDelta]: string;\n  [DataStreamStreamChunkType.Data]: ReadonlyJSONValue[];\n  [DataStreamStreamChunkType.Annotation]: ReadonlyJSONValue[];\n  [DataStreamStreamChunkType.ToolCall]: {\n    toolCallId: string;\n    toolName: string;\n    args: ReadonlyJSONObject;\n  };\n  [DataStreamStreamChunkType.StartToolCall]: {\n    toolCallId: string;\n    toolName: string;\n    parentId?: string;\n  };\n  [DataStreamStreamChunkType.ToolCallArgsTextDelta]: {\n    toolCallId: string;\n    argsTextDelta: string;\n  };\n  [DataStreamStreamChunkType.ToolCallResult]: {\n    toolCallId: string;\n    result: ReadonlyJSONValue;\n\n    // aui-extensions\n    artifact?: ReadonlyJSONValue | undefined;\n    isError?: boolean;\n  };\n  [DataStreamStreamChunkType.Error]: string;\n  [DataStreamStreamChunkType.FinishStep]: {\n    finishReason: LanguageModelV1FinishReason;\n    usage: LanguageModelV1Usage;\n    isContinued: boolean;\n  };\n  [DataStreamStreamChunkType.FinishMessage]: {\n    finishReason: LanguageModelV1FinishReason;\n    usage: LanguageModelV1Usage;\n  };\n  [DataStreamStreamChunkType.StartStep]: {\n    messageId: string;\n  };\n  [DataStreamStreamChunkType.ReasoningDelta]: string;\n  [DataStreamStreamChunkType.Source]: {\n    sourceType: \"url\";\n    id: string;\n    url: string;\n    title?: string;\n    parentId?: string;\n  };\n  [DataStreamStreamChunkType.RedactedReasoning]: { data: string };\n  [DataStreamStreamChunkType.ReasoningSignature]: { signature: string };\n  [DataStreamStreamChunkType.File]: { data: string; mimeType: string };\n\n  // aui-extensions\n  [DataStreamStreamChunkType.AuiUpdateStateOperations]: ObjectStreamOperation[];\n  [DataStreamStreamChunkType.AuiTextDelta]: {\n    textDelta: string;\n    parentId: string;\n  };\n  [DataStreamStreamChunkType.AuiReasoningDelta]: {\n    reasoningDelta: string;\n    parentId: string;\n  };\n};\n"],"names":[],"mappings":";;;;AA2BA,IAAY,yBAqBX;AArBD,CAAA,SAAY,yBAAyB;IACnC,yBAAA,CAAA,YAAA,GAAA,GAAe,CAAA;IACf,yBAAA,CAAA,OAAA,GAAA,GAAU,CAAA;IACV,yBAAA,CAAA,QAAA,GAAA,GAAW,CAAA;IACX,yBAAA,CAAA,aAAA,GAAA,GAAgB,CAAA;IAChB,yBAAA,CAAA,WAAA,GAAA,GAAc,CAAA;IACd,yBAAA,CAAA,iBAAA,GAAA,GAAoB,CAAA;IACpB,yBAAA,CAAA,gBAAA,GAAA,GAAmB,CAAA;IACnB,yBAAA,CAAA,wBAAA,GAAA,GAA2B,CAAA;IAC3B,yBAAA,CAAA,gBAAA,GAAA,GAAmB,CAAA;IACnB,yBAAA,CAAA,aAAA,GAAA,GAAgB,CAAA;IAChB,yBAAA,CAAA,YAAA,GAAA,GAAe,CAAA;IACf,yBAAA,CAAA,iBAAA,GAAA,GAAoB,CAAA;IACpB,yBAAA,CAAA,SAAA,GAAA,GAAY,CAAA;IACZ,yBAAA,CAAA,oBAAA,GAAA,GAAuB,CAAA;IACvB,yBAAA,CAAA,qBAAA,GAAA,GAAwB,CAAA;IACxB,yBAAA,CAAA,OAAA,GAAA,GAAU,CAAA;IAEV,yBAAA,CAAA,2BAAA,GAAA,WAAsC,CAAA;IACtC,yBAAA,CAAA,eAAA,GAAA,gBAA+B,CAAA;IAC/B,yBAAA,CAAA,oBAAA,GAAA,qBAAyC,CAAA;AAC3C,CAAC,EArBW,yBAAyB,IAAA,CAAzB,yBAAyB,GAAA,CAAA,CAAA,GAqBpC"}},
    {"offset": {"line": 524, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/LineDecoderStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/LineDecoderStream.ts"],"sourcesContent":["export class LineDecoderStream extends TransformStream<string, string> {\n  private buffer = \"\";\n\n  constructor() {\n    super({\n      transform: (chunk, controller) => {\n        this.buffer += chunk;\n        const lines = this.buffer.split(\"\\n\");\n\n        // Process all complete lines\n        for (let i = 0; i < lines.length - 1; i++) {\n          controller.enqueue(lines[i]);\n        }\n\n        // Keep the last incomplete line in the buffer\n        this.buffer = lines[lines.length - 1] || \"\";\n      },\n      flush: () => {\n        // If there's content in the buffer when the stream ends, it means\n        // the stream ended with an incomplete line (no trailing newline)\n        if (this.buffer) {\n          throw new Error(\n            `Stream ended with an incomplete line: \"${this.buffer}\"`,\n          );\n        }\n      },\n    });\n  }\n}\n"],"names":[],"mappings":";;;;AAAM,MAAO,iBAAkB,SAAQ,eAA+B;IAC5D,MAAM,GAAG,EAAE,CAAC;IAEpB,aAAA;QACE,KAAK,CAAC;YACJ,SAAS,EAAE,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE;gBAC/B,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC;gBACrB,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAEtC,6BAA6B;gBAC7B,IAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,CAAE,CAAC;oBAC1C,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/B,CAAC;gBAED,8CAA8C;gBAC9C,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;YAC9C,CAAC;YACD,KAAK,EAAE,GAAG,EAAE;gBACV,kEAAkE;gBAClE,iEAAiE;gBACjE,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;oBAChB,MAAM,IAAI,KAAK,CACb,CAAA,uCAAA,EAA0C,IAAI,CAAC,MAAM,CAAA,CAAA,CAAG,CACzD,CAAC;gBACJ,CAAC;YACH,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 556, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/serialization/data-stream/serialization.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/serialization/data-stream/serialization.ts"],"sourcesContent":["import { DataStreamChunk, DataStreamStreamChunkType } from \"./chunk-types\";\n\nexport class DataStreamChunkEncoder extends TransformStream<\n  DataStreamChunk,\n  string\n> {\n  constructor() {\n    super({\n      transform: (chunk, controller) => {\n        controller.enqueue(`${chunk.type}:${JSON.stringify(chunk.value)}\\n`);\n      },\n    });\n  }\n}\n\nexport class DataStreamChunkDecoder extends TransformStream<\n  string,\n  DataStreamChunk\n> {\n  constructor() {\n    super({\n      transform: (chunk, controller) => {\n        const index = chunk.indexOf(\":\");\n        if (index === -1) throw new Error(\"Invalid stream part\");\n        controller.enqueue({\n          type: chunk.slice(0, index) as DataStreamStreamChunkType,\n          value: JSON.parse(chunk.slice(index + 1)),\n        });\n      },\n    });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEM,MAAO,sBAAuB,SAAQ,eAG3C;IACC,aAAA;QACE,KAAK,CAAC;YACJ,SAAS,EAAE,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE;gBAC/B,UAAU,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,IAAI,CAAA,CAAA,EAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA,EAAA,CAAI,CAAC,CAAC;YACvE,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF;AAEK,MAAO,sBAAuB,SAAQ,eAG3C;IACC,aAAA;QACE,KAAK,CAAC;YACJ,SAAS,EAAE,CAAC,KAAK,EAAE,UAAU,EAAE,EAAE;gBAC/B,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;gBACjC,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;gBACzD,UAAU,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAA8B;oBACxD,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;iBAC1C,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 589, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/AssistantMetaTransformStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/AssistantMetaTransformStream.ts"],"sourcesContent":["import { AssistantStreamChunk, PartInit } from \"../../AssistantStreamChunk\";\n\n/**\n * For chunk types that are associated with a part,\n * we require a nonâ€‘nullable meta field.\n */\nexport type AssistantMetaStreamChunk =\n  | (AssistantStreamChunk & {\n      type: \"text-delta\" | \"part-finish\";\n      meta: PartInit;\n    })\n  | (AssistantStreamChunk & {\n      type: \"result\" | \"tool-call-args-text-finish\";\n      meta: PartInit & { type: \"tool-call\" };\n    })\n  | (AssistantStreamChunk & {\n      type: Exclude<\n        AssistantStreamChunk[\"type\"],\n        \"text-delta\" | \"result\" | \"tool-call-args-text-finish\" | \"part-finish\"\n      >;\n    });\nexport class AssistantMetaTransformStream extends TransformStream<\n  AssistantStreamChunk,\n  AssistantMetaStreamChunk\n> {\n  constructor() {\n    // We use an array to record parts as they are introduced.\n    const parts: PartInit[] = [];\n\n    super({\n      transform(chunk, controller) {\n        // For chunks that introduce a new part.\n        if (chunk.type === \"part-start\") {\n          if (chunk.path.length !== 0) {\n            controller.error(new Error(\"Nested parts are not supported\"));\n            return;\n          }\n          parts.push(chunk.part);\n          controller.enqueue(chunk);\n          return;\n        }\n\n        // For chunks that expect an associated part.\n        if (\n          chunk.type === \"text-delta\" ||\n          chunk.type === \"result\" ||\n          chunk.type === \"part-finish\" ||\n          chunk.type === \"tool-call-args-text-finish\"\n        ) {\n          if (chunk.path.length !== 1) {\n            controller.error(\n              new Error(`${chunk.type} chunks must have a path of length 1`),\n            );\n            return;\n          }\n          const idx = chunk.path[0]!;\n          if (idx < 0 || idx >= parts.length) {\n            controller.error(new Error(`Invalid path index: ${idx}`));\n            return;\n          }\n          const part = parts[idx]!;\n\n          controller.enqueue({\n            ...chunk,\n            meta: part as any, // TODO\n          });\n          return;\n        }\n\n        controller.enqueue(chunk);\n      },\n    });\n  }\n}\n"],"names":[],"mappings":";;;;AAqBM,MAAO,4BAA6B,SAAQ,eAGjD;IACC,aAAA;QACE,0DAA0D;QAC1D,MAAM,KAAK,GAAe,EAAE,CAAC;QAE7B,KAAK,CAAC;YACJ,SAAS,EAAC,KAAK,EAAE,UAAU;gBACzB,wCAAwC;gBACxC,IAAI,KAAK,CAAC,IAAI,KAAK,YAAY,EAAE,CAAC;oBAChC,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;wBAC5B,UAAU,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC,CAAC;wBAC9D,OAAO;oBACT,CAAC;oBACD,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;oBACvB,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;oBAC1B,OAAO;gBACT,CAAC;gBAED,6CAA6C;gBAC7C,IACE,KAAK,CAAC,IAAI,KAAK,YAAY,IAC3B,KAAK,CAAC,IAAI,KAAK,QAAQ,IACvB,KAAK,CAAC,IAAI,KAAK,aAAa,IAC5B,KAAK,CAAC,IAAI,KAAK,4BAA4B,EAC3C,CAAC;oBACD,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;wBAC5B,UAAU,CAAC,KAAK,CACd,IAAI,KAAK,CAAC,GAAG,KAAK,CAAC,IAAI,CAAA,oCAAA,CAAsC,CAAC,CAC/D,CAAC;wBACF,OAAO;oBACT,CAAC;oBACD,MAAM,GAAG,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,CAAE,CAAC;oBAC3B,IAAI,GAAG,GAAG,CAAC,IAAI,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;wBACnC,UAAU,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,CAAA,oBAAA,EAAuB,GAAG,EAAE,CAAC,CAAC,CAAC;wBAC1D,OAAO;oBACT,CAAC;oBACD,MAAM,IAAI,GAAG,KAAK,CAAC,GAAG,CAAE,CAAC;oBAEzB,UAAU,CAAC,OAAO,CAAC;wBACjB,GAAG,KAAK;wBACR,IAAI,EAAE,IAAW,EAAE,OAAO;qBAC3B,CAAC,CAAC;oBACH,OAAO;gBACT,CAAC;gBAED,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAC5B,CAAC;SACF,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 636, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/serialization/data-stream/DataStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/serialization/data-stream/DataStream.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"../../AssistantStreamChunk\";\nimport { ToolCallStreamController } from \"../../modules/tool-call\";\nimport { AssistantTransformStream } from \"../../utils/stream/AssistantTransformStream\";\nimport { PipeableTransformStream } from \"../../utils/stream/PipeableTransformStream\";\nimport { DataStreamChunk, DataStreamStreamChunkType } from \"./chunk-types\";\nimport { LineDecoderStream } from \"../../utils/stream/LineDecoderStream\";\nimport {\n  DataStreamChunkDecoder,\n  DataStreamChunkEncoder,\n} from \"./serialization\";\nimport {\n  AssistantMetaStreamChunk,\n  AssistantMetaTransformStream,\n} from \"../../utils/stream/AssistantMetaTransformStream\";\nimport { TextStreamController } from \"../../modules/text\";\nimport { AssistantStreamEncoder } from \"../../AssistantStream\";\n\nexport class DataStreamEncoder\n  extends PipeableTransformStream<AssistantStreamChunk, Uint8Array<ArrayBuffer>>\n  implements AssistantStreamEncoder\n{\n  headers = new Headers({\n    \"Content-Type\": \"text/plain; charset=utf-8\",\n    \"x-vercel-ai-data-stream\": \"v1\",\n  });\n\n  constructor() {\n    super((readable) => {\n      const transform = new TransformStream<\n        AssistantMetaStreamChunk,\n        DataStreamChunk\n      >({\n        transform(chunk, controller) {\n          const type = chunk.type;\n          switch (type) {\n            case \"part-start\": {\n              const part = chunk.part;\n              if (part.type === \"tool-call\") {\n                const { type, ...value } = part;\n                controller.enqueue({\n                  type: DataStreamStreamChunkType.StartToolCall,\n                  value,\n                });\n              }\n              if (part.type === \"source\") {\n                const { type, ...value } = part;\n                controller.enqueue({\n                  type: DataStreamStreamChunkType.Source,\n                  value,\n                });\n              }\n              break;\n            }\n            case \"text-delta\": {\n              const part = chunk.meta;\n              switch (part.type) {\n                case \"text\": {\n                  if (part.parentId) {\n                    controller.enqueue({\n                      type: DataStreamStreamChunkType.AuiTextDelta,\n                      value: {\n                        textDelta: chunk.textDelta,\n                        parentId: part.parentId,\n                      },\n                    });\n                  } else {\n                    controller.enqueue({\n                      type: DataStreamStreamChunkType.TextDelta,\n                      value: chunk.textDelta,\n                    });\n                  }\n                  break;\n                }\n                case \"reasoning\": {\n                  if (part.parentId) {\n                    controller.enqueue({\n                      type: DataStreamStreamChunkType.AuiReasoningDelta,\n                      value: {\n                        reasoningDelta: chunk.textDelta,\n                        parentId: part.parentId,\n                      },\n                    });\n                  } else {\n                    controller.enqueue({\n                      type: DataStreamStreamChunkType.ReasoningDelta,\n                      value: chunk.textDelta,\n                    });\n                  }\n                  break;\n                }\n                case \"tool-call\": {\n                  controller.enqueue({\n                    type: DataStreamStreamChunkType.ToolCallArgsTextDelta,\n                    value: {\n                      toolCallId: part.toolCallId,\n                      argsTextDelta: chunk.textDelta,\n                    },\n                  });\n                  break;\n                }\n                default:\n                  throw new Error(\n                    `Unsupported part type for text-delta: ${part.type}`,\n                  );\n              }\n              break;\n            }\n            case \"result\": {\n              // Only tool-call parts can have results.\n              const part = chunk.meta;\n              if (part.type !== \"tool-call\") {\n                throw new Error(\n                  `Result chunk on non-tool-call part not supported: ${part.type}`,\n                );\n              }\n              controller.enqueue({\n                type: DataStreamStreamChunkType.ToolCallResult,\n                value: {\n                  toolCallId: part.toolCallId,\n                  result: chunk.result,\n                  artifact: chunk.artifact,\n                  ...(chunk.isError ? { isError: chunk.isError } : {}),\n                },\n              });\n              break;\n            }\n            case \"step-start\": {\n              const { type, ...value } = chunk;\n              controller.enqueue({\n                type: DataStreamStreamChunkType.StartStep,\n                value,\n              });\n              break;\n            }\n            case \"step-finish\": {\n              const { type, ...value } = chunk;\n              controller.enqueue({\n                type: DataStreamStreamChunkType.FinishStep,\n                value,\n              });\n              break;\n            }\n            case \"message-finish\": {\n              const { type, ...value } = chunk;\n              controller.enqueue({\n                type: DataStreamStreamChunkType.FinishMessage,\n                value,\n              });\n              break;\n            }\n            case \"error\": {\n              controller.enqueue({\n                type: DataStreamStreamChunkType.Error,\n                value: chunk.error,\n              });\n              break;\n            }\n            case \"annotations\": {\n              controller.enqueue({\n                type: DataStreamStreamChunkType.Annotation,\n                value: chunk.annotations,\n              });\n              break;\n            }\n            case \"data\": {\n              controller.enqueue({\n                type: DataStreamStreamChunkType.Data,\n                value: chunk.data,\n              });\n              break;\n            }\n\n            case \"update-state\": {\n              controller.enqueue({\n                type: DataStreamStreamChunkType.AuiUpdateStateOperations,\n                value: chunk.operations,\n              });\n              break;\n            }\n\n            // TODO ignore for now\n            // in the future, we should create a handler that waits for text parts to finish before continuing\n            case \"tool-call-args-text-finish\":\n            case \"part-finish\":\n              break;\n\n            default: {\n              const exhaustiveCheck: never = type;\n              throw new Error(`Unsupported chunk type: ${exhaustiveCheck}`);\n            }\n          }\n        },\n      });\n\n      return readable\n        .pipeThrough(new AssistantMetaTransformStream())\n        .pipeThrough(transform)\n        .pipeThrough(new DataStreamChunkEncoder())\n        .pipeThrough(new TextEncoderStream());\n    });\n  }\n}\n\nconst TOOL_CALL_ARGS_CLOSING_CHUNKS = [\n  DataStreamStreamChunkType.StartToolCall,\n  DataStreamStreamChunkType.ToolCall,\n  DataStreamStreamChunkType.TextDelta,\n  DataStreamStreamChunkType.ReasoningDelta,\n  DataStreamStreamChunkType.Source,\n  DataStreamStreamChunkType.Error,\n  DataStreamStreamChunkType.FinishStep,\n  DataStreamStreamChunkType.FinishMessage,\n  DataStreamStreamChunkType.AuiTextDelta,\n  DataStreamStreamChunkType.AuiReasoningDelta,\n];\n\nexport class DataStreamDecoder extends PipeableTransformStream<\n  Uint8Array<ArrayBuffer>,\n  AssistantStreamChunk\n> {\n  constructor() {\n    super((readable) => {\n      const toolCallControllers = new Map<string, ToolCallStreamController>();\n      let activeToolCallArgsText: TextStreamController | undefined;\n      const transform = new AssistantTransformStream<DataStreamChunk>({\n        transform(chunk, controller) {\n          const { type, value } = chunk;\n\n          if (TOOL_CALL_ARGS_CLOSING_CHUNKS.includes(type)) {\n            activeToolCallArgsText?.close();\n            activeToolCallArgsText = undefined;\n          }\n\n          switch (type) {\n            case DataStreamStreamChunkType.ReasoningDelta:\n              controller.appendReasoning(value);\n              break;\n\n            case DataStreamStreamChunkType.TextDelta:\n              controller.appendText(value);\n              break;\n\n            case DataStreamStreamChunkType.AuiTextDelta:\n              controller\n                .withParentId(value.parentId)\n                .appendText(value.textDelta);\n              break;\n\n            case DataStreamStreamChunkType.AuiReasoningDelta:\n              controller\n                .withParentId(value.parentId)\n                .appendReasoning(value.reasoningDelta);\n              break;\n\n            case DataStreamStreamChunkType.StartToolCall: {\n              const { toolCallId, toolName, parentId } = value;\n              const ctrl = parentId\n                ? controller.withParentId(parentId)\n                : controller;\n\n              if (toolCallControllers.has(toolCallId))\n                throw new Error(\n                  `Encountered duplicate tool call id: ${toolCallId}`,\n                );\n\n              const toolCallController = ctrl.addToolCallPart({\n                toolCallId,\n                toolName,\n              });\n              toolCallControllers.set(toolCallId, toolCallController);\n\n              activeToolCallArgsText = toolCallController.argsText;\n              break;\n            }\n\n            case DataStreamStreamChunkType.ToolCallArgsTextDelta: {\n              const { toolCallId, argsTextDelta } = value;\n              const toolCallController = toolCallControllers.get(toolCallId);\n              if (!toolCallController)\n                throw new Error(\n                  `Encountered tool call with unknown id: ${toolCallId}`,\n                );\n              toolCallController.argsText.append(argsTextDelta);\n              break;\n            }\n\n            case DataStreamStreamChunkType.ToolCallResult: {\n              const { toolCallId, artifact, result, isError } = value;\n              const toolCallController = toolCallControllers.get(toolCallId);\n              if (!toolCallController)\n                throw new Error(\n                  `Encountered tool call result with unknown id: ${toolCallId}`,\n                );\n              toolCallController.setResponse({\n                artifact,\n                result,\n                isError,\n              });\n              break;\n            }\n\n            case DataStreamStreamChunkType.ToolCall: {\n              const { toolCallId, toolName, args } = value;\n\n              let toolCallController = toolCallControllers.get(toolCallId);\n              if (toolCallController) {\n                toolCallController.argsText.close();\n              } else {\n                toolCallController = controller.addToolCallPart({\n                  toolCallId,\n                  toolName,\n                  args,\n                });\n                toolCallControllers.set(toolCallId, toolCallController);\n              }\n              break;\n            }\n\n            case DataStreamStreamChunkType.FinishMessage:\n              controller.enqueue({\n                type: \"message-finish\",\n                path: [],\n                ...value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.StartStep:\n              controller.enqueue({\n                type: \"step-start\",\n                path: [],\n                ...value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.FinishStep:\n              controller.enqueue({\n                type: \"step-finish\",\n                path: [],\n                ...value,\n              });\n              break;\n            case DataStreamStreamChunkType.Data:\n              controller.enqueue({\n                type: \"data\",\n                path: [],\n                data: value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.Annotation:\n              controller.enqueue({\n                type: \"annotations\",\n                path: [],\n                annotations: value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.Source: {\n              const { parentId, ...sourceData } = value;\n              const ctrl = parentId\n                ? controller.withParentId(parentId)\n                : controller;\n              ctrl.appendSource({\n                type: \"source\",\n                ...sourceData,\n              });\n              break;\n            }\n\n            case DataStreamStreamChunkType.Error:\n              controller.enqueue({\n                type: \"error\",\n                path: [],\n                error: value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.File:\n              controller.appendFile({\n                type: \"file\",\n                ...value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.AuiUpdateStateOperations:\n              controller.enqueue({\n                type: \"update-state\",\n                path: [],\n                operations: value,\n              });\n              break;\n\n            case DataStreamStreamChunkType.ReasoningSignature:\n            case DataStreamStreamChunkType.RedactedReasoning:\n              // ignore these for now\n              break;\n\n            default: {\n              const exhaustiveCheck: never = type;\n              throw new Error(`unsupported chunk type: ${exhaustiveCheck}`);\n            }\n          }\n        },\n        flush() {\n          activeToolCallArgsText?.close();\n          activeToolCallArgsText = undefined;\n          toolCallControllers.forEach((controller) => controller.close());\n          toolCallControllers.clear();\n        },\n      });\n\n      return readable\n        .pipeThrough(new TextDecoderStream())\n        .pipeThrough(new LineDecoderStream())\n        .pipeThrough(new DataStreamChunkDecoder())\n        .pipeThrough(transform);\n    });\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1012, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/generateId.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/generateId.tsx"],"sourcesContent":["import { customAlphabet } from \"nanoid/non-secure\";\n\nexport const generateId = customAlphabet(\n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n  7,\n);\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,cAAc,EAAE,MAAM,mBAAmB,CAAC;;AAE5C,MAAM,UAAU,OAAG,kKAAc,EACtC,gEAAgE,EAChE,CAAC,CACF,CAAC"}},
    {"offset": {"line": 1023, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/modules/assistant-stream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/modules/assistant-stream.ts"],"sourcesContent":["import { AssistantStream } from \"../AssistantStream\";\nimport { AssistantStreamChunk, PartInit } from \"../AssistantStreamChunk\";\nimport { createMergeStream } from \"../utils/stream/merge\";\nimport { createTextStreamController, TextStreamController } from \"./text\";\nimport {\n  createToolCallStreamController,\n  ToolCallStreamController,\n} from \"./tool-call\";\nimport { Counter } from \"../utils/Counter\";\nimport {\n  PathAppendEncoder,\n  PathMergeEncoder,\n} from \"../utils/stream/path-utils\";\nimport { DataStreamEncoder } from \"../serialization/data-stream/DataStream\";\nimport { FilePart, SourcePart } from \"../utils/types\";\nimport { generateId } from \"../utils/generateId\";\nimport {\n  ReadonlyJSONObject,\n  ReadonlyJSONValue,\n} from \"../../utils/json/json-value\";\nimport { ToolResponseLike } from \"../tool/ToolResponse\";\nimport { promiseWithResolvers } from \"../../utils/promiseWithResolvers\";\n\ntype ToolCallPartInit = {\n  toolCallId?: string;\n  toolName: string;\n  argsText?: string;\n  args?: ReadonlyJSONObject;\n  response?: ToolResponseLike<ReadonlyJSONValue>;\n};\n\nexport type AssistantStreamController = {\n  appendText(textDelta: string): void;\n  appendReasoning(reasoningDelta: string): void;\n  appendSource(options: SourcePart): void;\n  appendFile(options: FilePart): void;\n  addTextPart(): TextStreamController;\n  addToolCallPart(options: string): ToolCallStreamController;\n  addToolCallPart(options: ToolCallPartInit): ToolCallStreamController;\n  enqueue(chunk: AssistantStreamChunk): void;\n  merge(stream: AssistantStream): void;\n  close(): void;\n  withParentId(parentId: string): AssistantStreamController;\n};\n\n// Shared state between controller instances\ntype AssistantStreamControllerState = {\n  merger: ReturnType<typeof createMergeStream>;\n  append?:\n    | {\n        controller: TextStreamController;\n        kind: \"text\" | \"reasoning\";\n      }\n    | undefined;\n  contentCounter: Counter;\n  closeSubscriber?: () => void;\n};\n\nclass AssistantStreamControllerImpl implements AssistantStreamController {\n  private readonly _state: AssistantStreamControllerState;\n  private _parentId?: string;\n\n  constructor(state?: AssistantStreamControllerState) {\n    this._state = state || {\n      merger: createMergeStream(),\n      contentCounter: new Counter(),\n    };\n  }\n\n  get __internal_isClosed() {\n    return this._state.merger.isSealed();\n  }\n\n  __internal_getReadable() {\n    return this._state.merger.readable;\n  }\n\n  __internal_subscribeToClose(callback: () => void) {\n    this._state.closeSubscriber = callback;\n  }\n\n  private _addPart(part: PartInit, stream: AssistantStream) {\n    if (this._state.append) {\n      this._state.append.controller.close();\n      this._state.append = undefined;\n    }\n\n    this.enqueue({\n      type: \"part-start\",\n      part,\n      path: [],\n    });\n    this._state.merger.addStream(\n      stream.pipeThrough(\n        new PathAppendEncoder(this._state.contentCounter.value),\n      ),\n    );\n  }\n\n  merge(stream: AssistantStream) {\n    this._state.merger.addStream(\n      stream.pipeThrough(new PathMergeEncoder(this._state.contentCounter)),\n    );\n  }\n\n  appendText(textDelta: string) {\n    if (this._state.append?.kind !== \"text\") {\n      this._state.append = {\n        kind: \"text\",\n        controller: this.addTextPart(),\n      };\n    }\n    this._state.append.controller.append(textDelta);\n  }\n\n  appendReasoning(textDelta: string) {\n    if (this._state.append?.kind !== \"reasoning\") {\n      this._state.append = {\n        kind: \"reasoning\",\n        controller: this.addReasoningPart(),\n      };\n    }\n    this._state.append.controller.append(textDelta);\n  }\n\n  addTextPart() {\n    const [stream, controller] = createTextStreamController();\n    this._addPart({ type: \"text\" }, stream);\n    return controller;\n  }\n\n  addReasoningPart() {\n    const [stream, controller] = createTextStreamController();\n    this._addPart({ type: \"reasoning\" }, stream);\n    return controller;\n  }\n\n  addToolCallPart(\n    options: string | ToolCallPartInit,\n  ): ToolCallStreamController {\n    const opt = typeof options === \"string\" ? { toolName: options } : options;\n    const toolName = opt.toolName;\n    const toolCallId = opt.toolCallId ?? generateId();\n\n    const [stream, controller] = createToolCallStreamController();\n    this._addPart(\n      {\n        type: \"tool-call\",\n        toolName,\n        toolCallId,\n        ...(this._parentId && { parentId: this._parentId }),\n      },\n      stream,\n    );\n\n    if (opt.argsText !== undefined) {\n      controller.argsText.append(opt.argsText);\n      controller.argsText.close();\n    }\n    if (opt.args !== undefined) {\n      controller.argsText.append(JSON.stringify(opt.args));\n      controller.argsText.close();\n    }\n    if (opt.response !== undefined) {\n      controller.setResponse(opt.response);\n    }\n\n    return controller;\n  }\n\n  appendSource(options: SourcePart) {\n    this._addPart(\n      { ...options, ...(this._parentId && { parentId: this._parentId }) },\n      new ReadableStream({\n        start(controller) {\n          controller.enqueue({\n            type: \"part-finish\",\n            path: [],\n          });\n          controller.close();\n        },\n      }),\n    );\n  }\n\n  appendFile(options: FilePart) {\n    this._addPart(\n      options,\n      new ReadableStream({\n        start(controller) {\n          controller.enqueue({\n            type: \"part-finish\",\n            path: [],\n          });\n          controller.close();\n        },\n      }),\n    );\n  }\n\n  enqueue(chunk: AssistantStreamChunk) {\n    this._state.merger.enqueue(chunk);\n\n    if (chunk.type === \"part-start\" && chunk.path.length === 0) {\n      this._state.contentCounter.up();\n    }\n  }\n\n  withParentId(parentId: string): AssistantStreamController {\n    const controller = new AssistantStreamControllerImpl(this._state);\n    controller._parentId = parentId;\n    return controller;\n  }\n\n  close() {\n    this._state.append?.controller?.close();\n    this._state.merger.seal();\n\n    this._state.closeSubscriber?.();\n  }\n}\n\nexport function createAssistantStream(\n  callback: (controller: AssistantStreamController) => PromiseLike<void> | void,\n): AssistantStream {\n  const controller = new AssistantStreamControllerImpl();\n\n  const runTask = async () => {\n    try {\n      await callback(controller);\n    } catch (e) {\n      if (!controller.__internal_isClosed) {\n        controller.enqueue({\n          type: \"error\",\n          path: [],\n          error: String(e),\n        });\n      }\n      throw e;\n    } finally {\n      if (!controller.__internal_isClosed) {\n        controller.close();\n      }\n    }\n  };\n  runTask();\n\n  return controller.__internal_getReadable();\n}\n\nexport function createAssistantStreamController() {\n  const { resolve, promise } = promiseWithResolvers<void>();\n  let controller!: AssistantStreamController;\n  const stream = createAssistantStream((c) => {\n    controller = c;\n\n    (controller as AssistantStreamControllerImpl).__internal_subscribeToClose(\n      resolve,\n    );\n\n    return promise;\n  });\n  return [stream, controller] as const;\n}\n\nexport function createAssistantStreamResponse(\n  callback: (controller: AssistantStreamController) => PromiseLike<void> | void,\n) {\n  return AssistantStream.toResponse(\n    createAssistantStream(callback),\n    new DataStreamEncoder(),\n  );\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,OAAO,EAAE,eAAe,EAAE,8BAA2B;AAErD,OAAO,EAAE,iBAAiB,EAAE,iCAA8B;AAC1D,OAAO,EAAE,0BAA0B,EAAwB,kBAAe;AAC1E,OAAO,EACL,8BAA8B,GAE/B,uBAAoB;AACrB,OAAO,EAAE,OAAO,EAAE,4BAAyB;AAC3C,OAAO,EACL,iBAAiB,EACjB,gBAAgB,GACjB,sCAAmC;AACpC,OAAO,EAAE,iBAAiB,EAAE,mDAAgD;AAE5E,OAAO,EAAE,UAAU,EAAE,+BAA4B;AAMjD,OAAO,EAAE,oBAAoB,EAAE,4CAAyC;;;;;;;;;;AAqCxE,MAAM,6BAA6B;IAChB,MAAM,CAAiC;IAChD,SAAS,CAAU;IAE3B,YAAY,KAAsC,CAAA;QAChD,IAAI,CAAC,MAAM,GAAG,KAAK,IAAI;YACrB,MAAM,MAAE,oMAAiB,EAAE;YAC3B,cAAc,EAAE,IAAI,kLAAO,EAAE;SAC9B,CAAC;IACJ,CAAC;IAED,IAAI,mBAAmB,GAAA;QACrB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;IACvC,CAAC;IAED,sBAAsB,GAAA;QACpB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;IACrC,CAAC;IAED,2BAA2B,CAAC,QAAoB,EAAA;QAC9C,IAAI,CAAC,MAAM,CAAC,eAAe,GAAG,QAAQ,CAAC;IACzC,CAAC;IAEO,QAAQ,CAAC,IAAc,EAAE,MAAuB,EAAA;QACtD,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;YACvB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;YACtC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC;QACjC,CAAC;QAED,IAAI,CAAC,OAAO,CAAC;YACX,IAAI,EAAE,YAAY;YAClB,IAAI;YACJ,IAAI,EAAE,EAAE;SACT,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAC1B,MAAM,CAAC,WAAW,CAChB,IAAI,4MAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,CACxD,CACF,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,MAAuB,EAAA;QAC3B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAC1B,MAAM,CAAC,WAAW,CAAC,IAAI,2MAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CACrE,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,SAAiB,EAAA;QAC1B,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,KAAK,MAAM,EAAE,CAAC;YACxC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG;gBACnB,IAAI,EAAE,MAAM;gBACZ,UAAU,EAAE,IAAI,CAAC,WAAW,EAAE;aAC/B,CAAC;QACJ,CAAC;QACD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC;IAED,eAAe,CAAC,SAAiB,EAAA;QAC/B,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,KAAK,WAAW,EAAE,CAAC;YAC7C,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG;gBACnB,IAAI,EAAE,WAAW;gBACjB,UAAU,EAAE,IAAI,CAAC,gBAAgB,EAAE;aACpC,CAAC;QACJ,CAAC;QACD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC;IAED,WAAW,GAAA;QACT,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC,OAAG,oMAA0B,EAAE,CAAC;QAC1D,IAAI,CAAC,QAAQ,CAAC;YAAE,IAAI,EAAE,MAAM;QAAA,CAAE,EAAE,MAAM,CAAC,CAAC;QACxC,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,gBAAgB,GAAA;QACd,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC,OAAG,oMAA0B,EAAE,CAAC;QAC1D,IAAI,CAAC,QAAQ,CAAC;YAAE,IAAI,EAAE,WAAW;QAAA,CAAE,EAAE,MAAM,CAAC,CAAC;QAC7C,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,eAAe,CACb,OAAkC,EAAA;QAElC,MAAM,GAAG,GAAG,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC;YAAE,QAAQ,EAAE,OAAO;QAAA,CAAE,CAAC,CAAC,CAAC,OAAO,CAAC;QAC1E,MAAM,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;QAC9B,MAAM,UAAU,GAAG,GAAG,CAAC,UAAU,QAAI,wLAAU,EAAE,CAAC;QAElD,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC,OAAG,gNAA8B,EAAE,CAAC;QAC9D,IAAI,CAAC,QAAQ,CACX;YACE,IAAI,EAAE,WAAW;YACjB,QAAQ;YACR,UAAU;YACV,GAAG,AAAC,IAAI,CAAC,SAAS,IAAI;gBAAE,QAAQ,EAAE,IAAI,CAAC,SAAS;YAAA,CAAE,CAAC;SACpD,EACD,MAAM,CACP,CAAC;QAEF,IAAI,GAAG,CAAC,QAAQ,KAAK,SAAS,EAAE,CAAC;YAC/B,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YACzC,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;QAC9B,CAAC;QACD,IAAI,GAAG,CAAC,IAAI,KAAK,SAAS,EAAE,CAAC;YAC3B,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;YACrD,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;QAC9B,CAAC;QACD,IAAI,GAAG,CAAC,QAAQ,KAAK,SAAS,EAAE,CAAC;YAC/B,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvC,CAAC;QAED,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,YAAY,CAAC,OAAmB,EAAA;QAC9B,IAAI,CAAC,QAAQ,CACX;YAAE,GAAG,OAAO;YAAE,GAAG,AAAC,IAAI,CAAC,SAAS,IAAI;gBAAE,QAAQ,EAAE,IAAI,CAAC,SAAS;YAAA,CAAE,CAAC;QAAA,CAAE,EACnE,IAAI,cAAc,CAAC;YACjB,KAAK,EAAC,UAAU;gBACd,UAAU,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,aAAa;oBACnB,IAAI,EAAE,EAAE;iBACT,CAAC,CAAC;gBACH,UAAU,CAAC,KAAK,EAAE,CAAC;YACrB,CAAC;SACF,CAAC,CACH,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,OAAiB,EAAA;QAC1B,IAAI,CAAC,QAAQ,CACX,OAAO,EACP,IAAI,cAAc,CAAC;YACjB,KAAK,EAAC,UAAU;gBACd,UAAU,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,aAAa;oBACnB,IAAI,EAAE,EAAE;iBACT,CAAC,CAAC;gBACH,UAAU,CAAC,KAAK,EAAE,CAAC;YACrB,CAAC;SACF,CAAC,CACH,CAAC;IACJ,CAAC;IAED,OAAO,CAAC,KAA2B,EAAA;QACjC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAElC,IAAI,KAAK,CAAC,IAAI,KAAK,YAAY,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,EAAE,EAAE,CAAC;QAClC,CAAC;IACH,CAAC;IAED,YAAY,CAAC,QAAgB,EAAA;QAC3B,MAAM,UAAU,GAAG,IAAI,6BAA6B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAClE,UAAU,CAAC,SAAS,GAAG,QAAQ,CAAC;QAChC,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,KAAK,GAAA;QACH,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC;QACxC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QAE1B,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE,CAAC;IAClC,CAAC;CACF;AAEK,SAAU,qBAAqB,CACnC,QAA6E;IAE7E,MAAM,UAAU,GAAG,IAAI,6BAA6B,EAAE,CAAC;IAEvD,MAAM,OAAO,GAAG,KAAK,IAAI,EAAE;QACzB,IAAI,CAAC;YACH,MAAM,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC7B,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,mBAAmB,EAAE,CAAC;gBACpC,UAAU,CAAC,OAAO,CAAC;oBACjB,IAAI,EAAE,OAAO;oBACb,IAAI,EAAE,EAAE;oBACR,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;iBACjB,CAAC,CAAC;YACL,CAAC;YACD,MAAM,CAAC,CAAC;QACV,CAAC,QAAS,CAAC;YACT,IAAI,CAAC,UAAU,CAAC,mBAAmB,EAAE,CAAC;gBACpC,UAAU,CAAC,KAAK,EAAE,CAAC;YACrB,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IACF,OAAO,EAAE,CAAC;IAEV,OAAO,UAAU,CAAC,sBAAsB,EAAE,CAAC;AAC7C,CAAC;AAEK,SAAU,+BAA+B;IAC7C,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,OAAG,oMAAoB,EAAQ,CAAC;IAC1D,IAAI,UAAsC,CAAC;IAC3C,MAAM,MAAM,GAAG,qBAAqB,CAAC,CAAC,CAAC,EAAE,EAAE;QACzC,UAAU,GAAG,CAAC,CAAC;QAEd,UAA4C,CAAC,2BAA2B,CACvE,OAAO,CACR,CAAC;QAEF,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC,CAAC;IACH,OAAO;QAAC,MAAM;QAAE,UAAU;KAAU,CAAC;AACvC,CAAC;AAEK,SAAU,6BAA6B,CAC3C,QAA6E;IAE7E,OAAO,yLAAe,CAAC,UAAU,CAC/B,qBAAqB,CAAC,QAAQ,CAAC,EAC/B,IAAI,yNAAiB,EAAE,CACxB,CAAC;AACJ,CAAC"}},
    {"offset": {"line": 1229, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/stream/AssistantTransformStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/stream/AssistantTransformStream.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"../../AssistantStreamChunk\";\nimport {\n  AssistantStreamController,\n  createAssistantStreamController,\n} from \"../../modules/assistant-stream\";\n\ntype AssistantTransformerFlushCallback = (\n  controller: AssistantStreamController,\n) => void | PromiseLike<void>;\n\ntype AssistantTransformerStartCallback = (\n  controller: AssistantStreamController,\n) => void | PromiseLike<void>;\n\ntype AssistantTransformerTransformCallback<I> = (\n  chunk: I,\n  controller: AssistantStreamController,\n) => void | PromiseLike<void>;\n\ntype AssistantTransformer<I> = {\n  flush?: AssistantTransformerFlushCallback;\n  start?: AssistantTransformerStartCallback;\n  transform?: AssistantTransformerTransformCallback<I>;\n};\n\nexport class AssistantTransformStream<I> extends TransformStream<\n  I,\n  AssistantStreamChunk\n> {\n  constructor(\n    transformer: AssistantTransformer<I>,\n    writableStrategy?: QueuingStrategy<I>,\n    readableStrategy?: QueuingStrategy<AssistantStreamChunk>,\n  ) {\n    const [stream, runController] = createAssistantStreamController();\n\n    let runPipeTask: Promise<void>;\n    super(\n      {\n        start(controller) {\n          runPipeTask = stream\n            .pipeTo(\n              new WritableStream({\n                write(chunk) {\n                  controller.enqueue(chunk);\n                },\n                abort(reason?: any) {\n                  controller.error(reason);\n                },\n                close() {\n                  controller.terminate();\n                },\n              }),\n            )\n            .catch((error) => {\n              controller.error(error);\n            });\n\n          return transformer.start?.(runController);\n        },\n        transform(chunk) {\n          return transformer.transform?.(chunk, runController);\n        },\n        async flush() {\n          await transformer.flush?.(runController);\n          runController.close();\n          await runPipeTask;\n        },\n      },\n      writableStrategy,\n      readableStrategy,\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AACA,OAAO,EAEL,+BAA+B,GAChC,0CAAuC;;AAqBlC,MAAO,wBAA4B,SAAQ,eAGhD;IACC,YACE,WAAoC,EACpC,gBAAqC,EACrC,gBAAwD,CAAA;QAExD,MAAM,CAAC,MAAM,EAAE,aAAa,CAAC,OAAG,wNAA+B,EAAE,CAAC;QAElE,IAAI,WAA0B,CAAC;QAC/B,KAAK,CACH;YACE,KAAK,EAAC,UAAU;gBACd,WAAW,GAAG,MAAM,CACjB,MAAM,CACL,IAAI,cAAc,CAAC;oBACjB,KAAK,EAAC,KAAK;wBACT,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;oBAC5B,CAAC;oBACD,KAAK,EAAC,MAAY;wBAChB,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;oBAC3B,CAAC;oBACD,KAAK;wBACH,UAAU,CAAC,SAAS,EAAE,CAAC;oBACzB,CAAC;iBACF,CAAC,CACH,CACA,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE;oBACf,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBAC1B,CAAC,CAAC,CAAC;gBAEL,OAAO,WAAW,CAAC,KAAK,EAAE,CAAC,aAAa,CAAC,CAAC;YAC5C,CAAC;YACD,SAAS,EAAC,KAAK;gBACb,OAAO,WAAW,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;YACvD,CAAC;YACD,KAAK,CAAC,KAAK;gBACT,MAAM,WAAW,CAAC,KAAK,EAAE,CAAC,aAAa,CAAC,CAAC;gBACzC,aAAa,CAAC,KAAK,EAAE,CAAC;gBACtB,MAAM,WAAW,CAAC;YACpB,CAAC;SACF,EACD,gBAAgB,EAChB,gBAAgB,CACjB,CAAC;IACJ,CAAC;CACF"}},
    {"offset": {"line": 1271, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/serialization/PlainText.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/serialization/PlainText.ts"],"sourcesContent":["import { AssistantStreamEncoder } from \"../AssistantStream\";\nimport { AssistantStreamChunk } from \"../AssistantStreamChunk\";\nimport { AssistantTransformStream } from \"../utils/stream/AssistantTransformStream\";\nimport { PipeableTransformStream } from \"../utils/stream/PipeableTransformStream\";\n\nexport class PlainTextEncoder\n  extends PipeableTransformStream<AssistantStreamChunk, Uint8Array<ArrayBuffer>>\n  implements AssistantStreamEncoder\n{\n  headers = new Headers({\n    \"Content-Type\": \"text/plain; charset=utf-8\",\n    \"x-vercel-ai-data-stream\": \"v1\",\n  });\n\n  constructor() {\n    super((readable) => {\n      const transform = new TransformStream<AssistantStreamChunk, string>({\n        transform(chunk, controller) {\n          const type = chunk.type;\n          switch (type) {\n            case \"text-delta\":\n              controller.enqueue(chunk.textDelta);\n              break;\n\n            case \"part-start\":\n            case \"part-finish\":\n            case \"step-start\":\n            case \"step-finish\":\n            case \"message-finish\":\n            case \"error\":\n              break;\n\n            default:\n              const unsupportedType:\n                | \"tool-call-args-text-finish\"\n                | \"data\"\n                | \"annotations\"\n                | \"tool-call-begin\"\n                | \"tool-call-delta\"\n                | \"result\"\n                | \"update-state\" = type;\n              throw new Error(`unsupported chunk type: ${unsupportedType}`);\n          }\n        },\n      });\n\n      return readable\n        .pipeThrough(transform)\n        .pipeThrough(new TextEncoderStream());\n    });\n  }\n}\n\nexport class PlainTextDecoder extends PipeableTransformStream<\n  Uint8Array<ArrayBuffer>,\n  AssistantStreamChunk\n> {\n  constructor() {\n    super((readable) => {\n      const transform = new AssistantTransformStream<string>({\n        transform(chunk, controller) {\n          controller.appendText(chunk);\n        },\n      });\n\n      return readable\n        .pipeThrough(new TextDecoderStream())\n        .pipeThrough(transform);\n    });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEA,OAAO,EAAE,wBAAwB,EAAE,oDAAiD;AACpF,OAAO,EAAE,uBAAuB,EAAE,mDAAgD;;;AAE5E,MAAO,gBACX,SAAQ,4NAAsE;IAG9E,OAAO,GAAG,IAAI,OAAO,CAAC;QACpB,cAAc,EAAE,2BAA2B;QAC3C,yBAAyB,EAAE,IAAI;KAChC,CAAC,CAAC;IAEH,aAAA;QACE,KAAK,CAAC,CAAC,QAAQ,EAAE,EAAE;YACjB,MAAM,SAAS,GAAG,IAAI,eAAe,CAA+B;gBAClE,SAAS,EAAC,KAAK,EAAE,UAAU;oBACzB,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;oBACxB,OAAQ,IAAI,EAAE,CAAC;wBACb,KAAK,YAAY;4BACf,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;4BACpC,MAAM;wBAER,KAAK,YAAY,CAAC;wBAClB,KAAK,aAAa,CAAC;wBACnB,KAAK,YAAY,CAAC;wBAClB,KAAK,aAAa,CAAC;wBACnB,KAAK,gBAAgB,CAAC;wBACtB,KAAK,OAAO;4BACV,MAAM;wBAER;4BACE,MAAM,eAAe,GAOA,IAAI,CAAC;4BAC1B,MAAM,IAAI,KAAK,CAAC,CAAA,wBAAA,EAA2B,eAAe,EAAE,CAAC,CAAC;oBAClE,CAAC;gBACH,CAAC;aACF,CAAC,CAAC;YAEH,OAAO,QAAQ,CACZ,WAAW,CAAC,SAAS,CAAC,CACtB,WAAW,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;IACL,CAAC;CACF;AAEK,MAAO,gBAAiB,SAAQ,4NAGrC;IACC,aAAA;QACE,KAAK,CAAC,CAAC,QAAQ,EAAE,EAAE;YACjB,MAAM,SAAS,GAAG,IAAI,8NAAwB,CAAS;gBACrD,SAAS,EAAC,KAAK,EAAE,UAAU;oBACzB,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBAC/B,CAAC;aACF,CAAC,CAAC;YAEH,OAAO,QAAQ,CACZ,WAAW,CAAC,IAAI,iBAAiB,EAAE,CAAC,CACpC,WAAW,CAAC,SAAS,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 1328, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/utils/json/fix-json.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/utils/json/fix-json.ts"],"sourcesContent":["// LICENSE for this file only\n\n// MIT License\n\n// Copyright (c) 2025 AgentbaseAI Inc.\n// Copyright (c) 2023 Lars Grammel\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\ntype State =\n  | \"ROOT\"\n  | \"FINISH\"\n  | \"INSIDE_STRING\"\n  | \"INSIDE_STRING_ESCAPE\"\n  | \"INSIDE_LITERAL\"\n  | \"INSIDE_NUMBER\"\n  | \"INSIDE_OBJECT_START\"\n  | \"INSIDE_OBJECT_KEY\"\n  | \"INSIDE_OBJECT_AFTER_KEY\"\n  | \"INSIDE_OBJECT_BEFORE_VALUE\"\n  | \"INSIDE_OBJECT_AFTER_VALUE\"\n  | \"INSIDE_OBJECT_AFTER_COMMA\"\n  | \"INSIDE_ARRAY_START\"\n  | \"INSIDE_ARRAY_AFTER_VALUE\"\n  | \"INSIDE_ARRAY_AFTER_COMMA\";\n\n// Implemented as a scanner with additional fixing\n// that performs a single linear time scan pass over the partial JSON.\n//\n// The states should ideally match relevant states from the JSON spec:\n// https://www.json.org/json-en.html\n//\n// Please note that invalid JSON is not considered/covered, because it\n// is assumed that the resulting JSON will be processed by a standard\n// JSON parser that will detect any invalid JSON.\n\n// Returns a tuple of [fixedJson, partialPath]\n// partialPath is an array of object/array keys that represent\n// the currently partial values. An object is considered partial\n// if through appending extra characters to the JSON string, its\n// value could change.\n\n// Example input: '{\"foo\":[{\"a\":f'\n// Example output: ['{\"foo\":[{\"a\":false}]}', ['foo', '0']]\n// Example input: '{\"foo\":'\n// Example output: ['{}', []]\n\nexport function fixJson(input: string): [string, string[]] {\n  const stack: State[] = [\"ROOT\"];\n  let lastValidIndex = -1;\n  let literalStart: number | null = null;\n  const path: string[] = [];\n  let currentKey: string | undefined;\n\n  function pushCurrentKeyToPath(): void {\n    if (currentKey !== undefined) {\n      path.push(JSON.parse(`\"${currentKey}\"`));\n      currentKey = undefined;\n    }\n  }\n\n  function processValueStart(char: string, i: number, swapState: State) {\n    switch (char) {\n      case '\"': {\n        lastValidIndex = i;\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_STRING\");\n\n        pushCurrentKeyToPath();\n        break;\n      }\n\n      case \"f\":\n      case \"t\":\n      case \"n\": {\n        lastValidIndex = i;\n        literalStart = i;\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_LITERAL\");\n        break;\n      }\n\n      case \"-\": {\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_NUMBER\");\n\n        pushCurrentKeyToPath();\n        break;\n      }\n      case \"0\":\n      case \"1\":\n      case \"2\":\n      case \"3\":\n      case \"4\":\n      case \"5\":\n      case \"6\":\n      case \"7\":\n      case \"8\":\n      case \"9\": {\n        lastValidIndex = i;\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_NUMBER\");\n\n        pushCurrentKeyToPath();\n        break;\n      }\n\n      case \"{\": {\n        lastValidIndex = i;\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_OBJECT_START\");\n\n        pushCurrentKeyToPath();\n        break;\n      }\n\n      case \"[\": {\n        lastValidIndex = i;\n        stack.pop();\n        stack.push(swapState);\n        stack.push(\"INSIDE_ARRAY_START\");\n\n        pushCurrentKeyToPath();\n        break;\n      }\n    }\n  }\n\n  function processAfterObjectValue(char: string, i: number) {\n    switch (char) {\n      case \",\": {\n        stack.pop();\n        stack.push(\"INSIDE_OBJECT_AFTER_COMMA\");\n        break;\n      }\n      case \"}\": {\n        lastValidIndex = i;\n        stack.pop();\n        currentKey = path.pop();\n        break;\n      }\n    }\n  }\n\n  function processAfterArrayValue(char: string, i: number) {\n    switch (char) {\n      case \",\": {\n        stack.pop();\n        stack.push(\"INSIDE_ARRAY_AFTER_COMMA\");\n        currentKey = (Number(currentKey) + 1).toString();\n        break;\n      }\n      case \"]\": {\n        lastValidIndex = i;\n        stack.pop();\n        currentKey = path.pop();\n        break;\n      }\n    }\n  }\n\n  for (let i = 0; i < input.length; i++) {\n    const char = input[i]!;\n    const currentState = stack[stack.length - 1];\n\n    switch (currentState) {\n      case \"ROOT\":\n        processValueStart(char, i, \"FINISH\");\n        break;\n\n      case \"INSIDE_OBJECT_START\": {\n        switch (char) {\n          case '\"': {\n            stack.pop();\n            stack.push(\"INSIDE_OBJECT_KEY\");\n            currentKey = \"\";\n            break;\n          }\n          case \"}\": {\n            lastValidIndex = i;\n            stack.pop();\n            currentKey = path.pop();\n            break;\n          }\n        }\n        break;\n      }\n\n      case \"INSIDE_OBJECT_AFTER_COMMA\": {\n        switch (char) {\n          case '\"': {\n            stack.pop();\n            stack.push(\"INSIDE_OBJECT_KEY\");\n            currentKey = \"\";\n            break;\n          }\n        }\n        break;\n      }\n\n      case \"INSIDE_OBJECT_KEY\": {\n        switch (char) {\n          case '\"': {\n            stack.pop();\n            stack.push(\"INSIDE_OBJECT_AFTER_KEY\");\n            break;\n          }\n          case \"\\\\\": {\n            stack.push(\"INSIDE_STRING_ESCAPE\");\n            currentKey += char;\n            break;\n          }\n          default: {\n            currentKey += char;\n            break;\n          }\n        }\n        break;\n      }\n\n      case \"INSIDE_OBJECT_AFTER_KEY\": {\n        switch (char) {\n          case \":\": {\n            stack.pop();\n            stack.push(\"INSIDE_OBJECT_BEFORE_VALUE\");\n\n            break;\n          }\n        }\n        break;\n      }\n\n      case \"INSIDE_OBJECT_BEFORE_VALUE\": {\n        processValueStart(char, i, \"INSIDE_OBJECT_AFTER_VALUE\");\n        break;\n      }\n\n      case \"INSIDE_OBJECT_AFTER_VALUE\": {\n        processAfterObjectValue(char, i);\n        break;\n      }\n\n      case \"INSIDE_STRING\": {\n        switch (char) {\n          case '\"': {\n            stack.pop();\n            lastValidIndex = i;\n\n            currentKey = path.pop();\n            break;\n          }\n\n          case \"\\\\\": {\n            stack.push(\"INSIDE_STRING_ESCAPE\");\n            break;\n          }\n\n          default: {\n            lastValidIndex = i;\n          }\n        }\n\n        break;\n      }\n\n      case \"INSIDE_ARRAY_START\": {\n        switch (char) {\n          case \"]\": {\n            lastValidIndex = i;\n            stack.pop();\n            currentKey = path.pop();\n            break;\n          }\n\n          default: {\n            lastValidIndex = i;\n            currentKey = \"0\";\n            processValueStart(char, i, \"INSIDE_ARRAY_AFTER_VALUE\");\n            break;\n          }\n        }\n        break;\n      }\n\n      case \"INSIDE_ARRAY_AFTER_VALUE\": {\n        switch (char) {\n          case \",\": {\n            stack.pop();\n            stack.push(\"INSIDE_ARRAY_AFTER_COMMA\");\n\n            currentKey = (Number(currentKey) + 1).toString();\n            break;\n          }\n\n          case \"]\": {\n            lastValidIndex = i;\n            stack.pop();\n            currentKey = path.pop();\n            break;\n          }\n\n          default: {\n            lastValidIndex = i;\n            break;\n          }\n        }\n\n        break;\n      }\n\n      case \"INSIDE_ARRAY_AFTER_COMMA\": {\n        processValueStart(char, i, \"INSIDE_ARRAY_AFTER_VALUE\");\n        break;\n      }\n\n      case \"INSIDE_STRING_ESCAPE\": {\n        stack.pop();\n\n        if (stack[stack.length - 1] === \"INSIDE_STRING\") {\n          lastValidIndex = i;\n        } else if (stack[stack.length - 1] === \"INSIDE_OBJECT_KEY\") {\n          currentKey += char;\n        }\n\n        break;\n      }\n\n      case \"INSIDE_NUMBER\": {\n        switch (char) {\n          case \"0\":\n          case \"1\":\n          case \"2\":\n          case \"3\":\n          case \"4\":\n          case \"5\":\n          case \"6\":\n          case \"7\":\n          case \"8\":\n          case \"9\": {\n            lastValidIndex = i;\n            break;\n          }\n\n          case \"e\":\n          case \"E\":\n          case \"-\":\n          case \".\": {\n            break;\n          }\n\n          case \",\": {\n            stack.pop();\n            currentKey = path.pop();\n\n            if (stack[stack.length - 1] === \"INSIDE_ARRAY_AFTER_VALUE\") {\n              processAfterArrayValue(char, i);\n            }\n\n            if (stack[stack.length - 1] === \"INSIDE_OBJECT_AFTER_VALUE\") {\n              processAfterObjectValue(char, i);\n            }\n\n            break;\n          }\n\n          case \"}\": {\n            stack.pop();\n            currentKey = path.pop();\n\n            if (stack[stack.length - 1] === \"INSIDE_OBJECT_AFTER_VALUE\") {\n              processAfterObjectValue(char, i);\n            }\n\n            break;\n          }\n\n          case \"]\": {\n            stack.pop();\n            currentKey = path.pop();\n\n            if (stack[stack.length - 1] === \"INSIDE_ARRAY_AFTER_VALUE\") {\n              processAfterArrayValue(char, i);\n            }\n\n            break;\n          }\n\n          default: {\n            stack.pop();\n            currentKey = path.pop();\n            break;\n          }\n        }\n\n        break;\n      }\n\n      case \"INSIDE_LITERAL\": {\n        const partialLiteral = input.substring(literalStart!, i + 1);\n\n        if (\n          !\"false\".startsWith(partialLiteral) &&\n          !\"true\".startsWith(partialLiteral) &&\n          !\"null\".startsWith(partialLiteral)\n        ) {\n          stack.pop();\n\n          if (stack[stack.length - 1] === \"INSIDE_OBJECT_AFTER_VALUE\") {\n            processAfterObjectValue(char, i);\n          } else if (stack[stack.length - 1] === \"INSIDE_ARRAY_AFTER_VALUE\") {\n            processAfterArrayValue(char, i);\n          }\n        } else {\n          lastValidIndex = i;\n        }\n\n        break;\n      }\n    }\n  }\n\n  let result = input.slice(0, lastValidIndex + 1);\n\n  for (let i = stack.length - 1; i >= 0; i--) {\n    const state = stack[i];\n\n    switch (state) {\n      case \"INSIDE_STRING\": {\n        result += '\"';\n        break;\n      }\n\n      case \"INSIDE_OBJECT_KEY\":\n      case \"INSIDE_OBJECT_AFTER_KEY\":\n      case \"INSIDE_OBJECT_AFTER_COMMA\":\n      case \"INSIDE_OBJECT_START\":\n      case \"INSIDE_OBJECT_BEFORE_VALUE\":\n      case \"INSIDE_OBJECT_AFTER_VALUE\": {\n        result += \"}\";\n        break;\n      }\n\n      case \"INSIDE_ARRAY_START\":\n      case \"INSIDE_ARRAY_AFTER_COMMA\":\n      case \"INSIDE_ARRAY_AFTER_VALUE\": {\n        result += \"]\";\n        break;\n      }\n\n      case \"INSIDE_LITERAL\": {\n        const partialLiteral = input.substring(literalStart!, input.length);\n\n        if (\"true\".startsWith(partialLiteral)) {\n          result += \"true\".slice(partialLiteral.length);\n        } else if (\"false\".startsWith(partialLiteral)) {\n          result += \"false\".slice(partialLiteral.length);\n        } else if (\"null\".startsWith(partialLiteral)) {\n          result += \"null\".slice(partialLiteral.length);\n        }\n      }\n    }\n  }\n\n  return [result, path];\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1763, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/utils/json/parse-partial-json-object.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/utils/json/parse-partial-json-object.ts"],"sourcesContent":["import sjson from \"secure-json-parse\";\nimport { fixJson } from \"./fix-json\";\nimport { ReadonlyJSONObject } from \"./json-value\";\n\nconst PARTIAL_JSON_OBJECT_META_SYMBOL = Symbol(\n  \"aui.parse-partial-json-object.meta\",\n);\n\ntype FieldState = \"complete\" | \"partial\";\n\ntype PartialJsonObjectMeta = {\n  state: \"complete\" | \"partial\";\n  partialPath: string[];\n};\n\nexport const getPartialJsonObjectMeta = (\n  obj: Record<symbol, unknown>,\n): PartialJsonObjectMeta | undefined => {\n  return obj?.[PARTIAL_JSON_OBJECT_META_SYMBOL] as PartialJsonObjectMeta;\n};\n\nexport const parsePartialJsonObject = (\n  json: string,\n):\n  | (ReadonlyJSONObject & {\n      [PARTIAL_JSON_OBJECT_META_SYMBOL]: PartialJsonObjectMeta;\n    })\n  | undefined => {\n  if (json.length === 0)\n    return {\n      [PARTIAL_JSON_OBJECT_META_SYMBOL]: { state: \"partial\", partialPath: [] },\n    };\n\n  try {\n    const res = sjson.parse(json);\n    if (typeof res !== \"object\" || res === null)\n      throw new Error(\"argsText is expected to be an object\");\n\n    res[PARTIAL_JSON_OBJECT_META_SYMBOL] = {\n      state: \"complete\",\n      partialPath: [],\n    };\n    return res;\n  } catch {\n    try {\n      const [fixedJson, partialPath] = fixJson(json);\n      const res = sjson.parse(fixedJson);\n      if (typeof res !== \"object\" || res === null)\n        throw new Error(\"argsText is expected to be an object\");\n\n      res[PARTIAL_JSON_OBJECT_META_SYMBOL] = {\n        state: \"partial\",\n        partialPath,\n      };\n      return res;\n    } catch {\n      return undefined;\n    }\n  }\n};\n\nconst getFieldState = (\n  parent: unknown,\n  parentMeta: PartialJsonObjectMeta,\n  fieldPath: string[],\n): FieldState => {\n  if (typeof parent !== \"object\" || parent === null) return parentMeta.state;\n\n  // 1) parent is complete: return \"complete\"\n  if (parentMeta.state === \"complete\") return \"complete\";\n\n  // 2) we finished traversing: return parent state\n  if (fieldPath.length === 0) return parentMeta.state;\n\n  const [field, ...restPath] = fieldPath as [string, ...string[]];\n\n  // 3) field doesn't yet exist in parent: return \"partial\"\n  if (!Object.prototype.hasOwnProperty.call(parent, field)) return \"partial\";\n\n  const [partialField, ...restPartialPath] = parentMeta.partialPath;\n\n  // 4) field exists but is not partial: return \"complete\"\n  if (field !== partialField) return \"complete\";\n\n  // 5) field exists and is partial: return child state\n  const child = (parent as Record<string, unknown>)[field];\n  const childMeta: PartialJsonObjectMeta = {\n    state: \"partial\",\n    partialPath: restPartialPath,\n  };\n\n  return getFieldState(child, childMeta, restPath);\n};\n\nexport const getPartialJsonObjectFieldState = (\n  obj: Record<string, unknown>,\n  fieldPath: (string | number)[],\n): FieldState => {\n  const meta = getPartialJsonObjectMeta(obj);\n  if (!meta) throw new Error(\"unable to determine object state\");\n\n  return getFieldState(obj, meta, fieldPath.map(String));\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1838, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/tool/ToolResponse.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/tool/ToolResponse.ts"],"sourcesContent":["import { ReadonlyJSONValue } from \"../../utils/json/json-value\";\n\nconst TOOL_RESPONSE_SYMBOL = Symbol.for(\"aui.tool-response\");\n\nexport type ToolResponseLike<TResult> = {\n  result: TResult;\n  artifact?: ReadonlyJSONValue | undefined;\n  isError?: boolean | undefined;\n};\n\nexport class ToolResponse<TResult> {\n  get [TOOL_RESPONSE_SYMBOL]() {\n    return true;\n  }\n\n  readonly artifact?: ReadonlyJSONValue;\n  readonly result: TResult;\n  readonly isError: boolean;\n\n  constructor(options: ToolResponseLike<TResult>) {\n    if (options.artifact !== undefined) {\n      this.artifact = options.artifact;\n    }\n    this.result = options.result;\n    this.isError = options.isError ?? false;\n  }\n\n  static [Symbol.hasInstance](\n    obj: unknown,\n  ): obj is ToolResponse<ReadonlyJSONValue> {\n    return (\n      typeof obj === \"object\" && obj !== null && TOOL_RESPONSE_SYMBOL in obj\n    );\n  }\n\n  static toResponse(result: any | ToolResponse<any>): ToolResponse<any> {\n    if (result instanceof ToolResponse) {\n      return result;\n    }\n    return new ToolResponse({\n      result: result === undefined ? \"<no result>\" : result,\n    });\n  }\n}\n"],"names":[],"mappings":";;;;AAEA,MAAM,oBAAoB,GAAG,MAAM,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;AAQvD,MAAO,YAAY;IACvB,IAAI,CAAC,oBAAoB,CAAC,GAAA;QACxB,OAAO,IAAI,CAAC;IACd,CAAC;IAEQ,QAAQ,CAAqB;IAC7B,MAAM,CAAU;IAChB,OAAO,CAAU;IAE1B,YAAY,OAAkC,CAAA;QAC5C,IAAI,OAAO,CAAC,QAAQ,KAAK,SAAS,EAAE,CAAC;YACnC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;QACnC,CAAC;QACD,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC7B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,KAAK,CAAC;IAC1C,CAAC;IAED,MAAM,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CACzB,GAAY,EAAA;QAEZ,OAAO,AACL,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,IAAI,IAAI,oBAAoB,IAAI,GAAG,CACvE,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,UAAU,CAAC,MAA+B,EAAA;QAC/C,IAAI,MAAM,YAAY,YAAY,EAAE,CAAC;YACnC,OAAO,MAAM,CAAC;QAChB,CAAC;QACD,OAAO,IAAI,YAAY,CAAC;YACtB,MAAM,EAAE,MAAM,KAAK,SAAS,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,MAAM;SACtD,CAAC,CAAC;IACL,CAAC;CACF"}},
    {"offset": {"line": 1873, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/object/ObjectStreamAccumulator.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/object/ObjectStreamAccumulator.ts"],"sourcesContent":["import { ReadonlyJSONValue, ReadonlyJSONObject } from \"../../utils\";\nimport { ObjectStreamOperation } from \"./types\";\n\nexport class ObjectStreamAccumulator {\n  private _state: ReadonlyJSONValue;\n\n  constructor(initialValue: ReadonlyJSONValue = null) {\n    this._state = initialValue;\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  append(ops: readonly ObjectStreamOperation[]) {\n    this._state = ops.reduce(\n      (state, op) => ObjectStreamAccumulator.apply(state, op),\n      this._state,\n    );\n  }\n\n  private static apply(state: ReadonlyJSONValue, op: ObjectStreamOperation) {\n    const type = op.type;\n    switch (type) {\n      case \"set\":\n        return ObjectStreamAccumulator.updatePath(\n          state,\n          op.path,\n          () => op.value,\n        );\n      case \"append-text\":\n        return ObjectStreamAccumulator.updatePath(state, op.path, (current) => {\n          if (typeof current !== \"string\")\n            throw new Error(`Expected string at path [${op.path.join(\", \")}]`);\n          return current + op.value;\n        });\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Invalid operation type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  private static updatePath(\n    state: ReadonlyJSONValue | undefined,\n    path: readonly string[],\n    updater: (current: ReadonlyJSONValue | undefined) => ReadonlyJSONValue,\n  ): ReadonlyJSONValue {\n    if (path.length === 0) return updater(state);\n\n    // Initialize state as empty object if it's null and we're trying to set a property\n    state ??= {};\n\n    if (typeof state !== \"object\") {\n      throw new Error(`Invalid path: [${path.join(\", \")}]`);\n    }\n\n    const [key, ...rest] = path as [string, ...(readonly string[])];\n    if (Array.isArray(state)) {\n      const idx = Number(key);\n      if (Number.isNaN(idx))\n        throw new Error(`Expected array index at [${path.join(\", \")}]`);\n      if (idx > state.length || idx < 0)\n        throw new Error(`Insert array index out of bounds`);\n\n      const nextState = [...state];\n      nextState[idx] = this.updatePath(nextState[idx], rest, updater);\n\n      return nextState;\n    }\n\n    const nextState = { ...(state as ReadonlyJSONObject) };\n    nextState[key] = this.updatePath(nextState[key], rest, updater);\n\n    return nextState;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1934, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/accumulators/assistant-message-accumulator.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/accumulators/assistant-message-accumulator.ts"],"sourcesContent":["import { AssistantStreamChunk } from \"../AssistantStreamChunk\";\nimport { generateId } from \"../utils/generateId\";\nimport { parsePartialJsonObject } from \"../../utils/json/parse-partial-json-object\";\nimport {\n  AssistantMessage,\n  AssistantMessageStatus,\n  TextPart,\n  ToolCallPart,\n  SourcePart,\n  AssistantMessagePart,\n  ReasoningPart,\n  FilePart,\n} from \"../utils/types\";\nimport { ObjectStreamAccumulator } from \"../object/ObjectStreamAccumulator\";\nimport { ReadonlyJSONValue } from \"../../utils\";\n\nexport const createInitialMessage = ({\n  unstable_state = null,\n}: {\n  unstable_state?: ReadonlyJSONValue;\n} = {}): AssistantMessage => ({\n  role: \"assistant\",\n  status: { type: \"running\" },\n  parts: [],\n  get content() {\n    return this.parts;\n  },\n  metadata: {\n    unstable_state,\n    unstable_data: [],\n    unstable_annotations: [],\n    steps: [],\n    custom: {},\n  },\n});\n\nconst updatePartForPath = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk,\n  updater: (part: AssistantMessagePart) => AssistantMessagePart,\n): AssistantMessage => {\n  if (message.parts.length === 0) {\n    throw new Error(\"No parts available to update.\");\n  }\n\n  if (chunk.path.length !== 1)\n    throw new Error(\"Nested paths are not supported yet.\");\n\n  const partIndex = chunk.path[0]!;\n  const updatedPart = updater(message.parts[partIndex]!);\n  return {\n    ...message,\n    parts: [\n      ...message.parts.slice(0, partIndex),\n      updatedPart,\n      ...message.parts.slice(partIndex + 1),\n    ],\n    get content() {\n      return this.parts;\n    },\n  };\n};\n\nconst handlePartStart = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { readonly type: \"part-start\" },\n): AssistantMessage => {\n  const partInit = chunk.part;\n  if (partInit.type === \"text\" || partInit.type === \"reasoning\") {\n    const newTextPart: TextPart | ReasoningPart = {\n      type: partInit.type,\n      text: \"\",\n      status: { type: \"running\" },\n      ...(partInit.parentId && { parentId: partInit.parentId }),\n    };\n    return {\n      ...message,\n      parts: [...message.parts, newTextPart],\n      get content() {\n        return this.parts;\n      },\n    };\n  } else if (partInit.type === \"tool-call\") {\n    const newToolCallPart: ToolCallPart = {\n      type: \"tool-call\",\n      state: \"partial-call\",\n      status: { type: \"running\", isArgsComplete: false },\n      toolCallId: partInit.toolCallId,\n      toolName: partInit.toolName,\n      argsText: \"\",\n      args: {},\n      ...(partInit.parentId && { parentId: partInit.parentId }),\n    };\n    return {\n      ...message,\n      parts: [...message.parts, newToolCallPart],\n      get content() {\n        return this.parts;\n      },\n    };\n  } else if (partInit.type === \"source\") {\n    const newSourcePart: SourcePart = {\n      type: \"source\",\n      sourceType: partInit.sourceType,\n      id: partInit.id,\n      url: partInit.url,\n      ...(partInit.title ? { title: partInit.title } : undefined),\n      ...(partInit.parentId && { parentId: partInit.parentId }),\n    };\n    return {\n      ...message,\n      parts: [...message.parts, newSourcePart],\n      get content() {\n        return this.parts;\n      },\n    };\n  } else if (partInit.type === \"file\") {\n    const newFilePart: FilePart = {\n      type: \"file\",\n      mimeType: partInit.mimeType,\n      data: partInit.data,\n    };\n    return {\n      ...message,\n      parts: [...message.parts, newFilePart],\n      get content() {\n        return this.parts;\n      },\n    };\n  } else {\n    throw new Error(`Unsupported part type: ${partInit.type}`);\n  }\n};\n\nconst handleToolCallArgsTextFinish = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & {\n    readonly type: \"tool-call-args-text-finish\";\n  },\n): AssistantMessage => {\n  return updatePartForPath(message, chunk, (part) => {\n    if (part.type !== \"tool-call\") {\n      throw new Error(\"Last is not a tool call\");\n    }\n\n    // TODO this should never be hit; this happens if args-text-finish is emitted after result\n    if (part.state !== \"partial-call\") return part;\n    // throw new Error(\"Last is not a partial call\");\n\n    return {\n      ...part,\n      state: \"call\",\n    };\n  });\n};\n\nconst handlePartFinish = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { readonly type: \"part-finish\" },\n): AssistantMessage => {\n  return updatePartForPath(message, chunk, (part) => ({\n    ...part,\n    status: { type: \"complete\", reason: \"unknown\" },\n  }));\n};\n\nconst handleTextDelta = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"text-delta\" },\n): AssistantMessage => {\n  return updatePartForPath(message, chunk, (part) => {\n    if (part.type === \"text\" || part.type === \"reasoning\") {\n      return { ...part, text: part.text + chunk.textDelta };\n    } else if (part.type === \"tool-call\") {\n      const newArgsText = part.argsText + chunk.textDelta;\n\n      // Fall back to existing args if parsing fails\n      const newArgs = parsePartialJsonObject(newArgsText) ?? part.args;\n\n      return { ...part, argsText: newArgsText, args: newArgs };\n    } else {\n      throw new Error(\n        \"text-delta received but part is neither text nor tool-call\",\n      );\n    }\n  });\n};\n\nconst handleResult = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"result\" },\n): AssistantMessage => {\n  return updatePartForPath(message, chunk, (part) => {\n    if (part.type === \"tool-call\") {\n      return {\n        ...part,\n        state: \"result\",\n        ...(chunk.artifact !== undefined ? { artifact: chunk.artifact } : {}),\n        result: chunk.result,\n        isError: chunk.isError ?? false,\n        status: { type: \"complete\", reason: \"stop\" },\n      };\n    } else {\n      throw new Error(\"Result chunk received but part is not a tool-call\");\n    }\n  });\n};\n\nconst handleMessageFinish = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"message-finish\" },\n): AssistantMessage => {\n  // avoid edge case where providers send finish chunks that overwrite message error status (issue #2181)\n  if (\n    message.status?.type === \"incomplete\" &&\n    message.status?.reason === \"error\"\n  ) {\n    return message;\n  }\n\n  const newStatus = getStatus(chunk);\n  return { ...message, status: newStatus };\n};\n\nconst getStatus = (\n  chunk:\n    | (AssistantStreamChunk & { type: \"message-finish\" })\n    | (AssistantStreamChunk & { type: \"step-finish\" }),\n): AssistantMessageStatus => {\n  if (chunk.finishReason === \"tool-calls\") {\n    return {\n      type: \"requires-action\",\n      reason: \"tool-calls\",\n    };\n  } else if (\n    chunk.finishReason === \"stop\" ||\n    chunk.finishReason === \"unknown\"\n  ) {\n    return {\n      type: \"complete\",\n      reason: chunk.finishReason,\n    };\n  } else {\n    return {\n      type: \"incomplete\",\n      reason: chunk.finishReason,\n    };\n  }\n};\n\nconst handleAnnotations = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"annotations\" },\n): AssistantMessage => {\n  return {\n    ...message,\n    metadata: {\n      ...message.metadata,\n      unstable_annotations: [\n        ...message.metadata.unstable_annotations,\n        ...chunk.annotations,\n      ],\n    },\n  };\n};\n\nconst handleData = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"data\" },\n): AssistantMessage => {\n  return {\n    ...message,\n    metadata: {\n      ...message.metadata,\n      unstable_data: [...message.metadata.unstable_data, ...chunk.data],\n    },\n  };\n};\n\nconst handleStepStart = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"step-start\" },\n): AssistantMessage => {\n  return {\n    ...message,\n    metadata: {\n      ...message.metadata,\n      steps: [\n        ...message.metadata.steps,\n        { state: \"started\", messageId: chunk.messageId },\n      ],\n    },\n  };\n};\n\nconst handleStepFinish = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"step-finish\" },\n): AssistantMessage => {\n  const steps = message.metadata.steps.slice();\n  const lastIndex = steps.length - 1;\n\n  // Check if the previous step is a step-start (has state \"started\")\n  if (steps.length > 0 && steps[lastIndex]?.state === \"started\") {\n    steps[lastIndex] = {\n      ...steps[lastIndex],\n      state: \"finished\",\n      finishReason: chunk.finishReason,\n      usage: chunk.usage,\n      isContinued: chunk.isContinued,\n    };\n  } else {\n    // If no previous step-start exists, append a finished step\n    steps.push({\n      state: \"finished\",\n      messageId: generateId(),\n      finishReason: chunk.finishReason,\n      usage: chunk.usage,\n      isContinued: chunk.isContinued,\n    });\n  }\n\n  return {\n    ...message,\n    metadata: {\n      ...message.metadata,\n      steps,\n    },\n  };\n};\n\nconst handleErrorChunk = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"error\" },\n): AssistantMessage => {\n  return {\n    ...message,\n    status: { type: \"incomplete\", reason: \"error\", error: chunk.error },\n  };\n};\n\nconst handleUpdateState = (\n  message: AssistantMessage,\n  chunk: AssistantStreamChunk & { type: \"update-state\" },\n): AssistantMessage => {\n  const acc = new ObjectStreamAccumulator(message.metadata.unstable_state);\n  acc.append(chunk.operations);\n\n  return {\n    ...message,\n    metadata: {\n      ...message.metadata,\n      unstable_state: acc.state,\n    },\n  };\n};\n\nconst throttleCallback = (callback: () => void) => {\n  let hasScheduled = false;\n  return () => {\n    if (hasScheduled) return;\n    hasScheduled = true;\n    queueMicrotask(() => {\n      hasScheduled = false;\n      callback();\n    });\n  };\n};\n\nexport class AssistantMessageAccumulator extends TransformStream<\n  AssistantStreamChunk,\n  AssistantMessage\n> {\n  constructor({\n    initialMessage,\n    throttle,\n    onError,\n  }: {\n    initialMessage?: AssistantMessage;\n    throttle?: boolean;\n    onError?: (error: string) => void;\n  } = {}) {\n    let message = initialMessage ?? createInitialMessage();\n    let controller:\n      | TransformStreamDefaultController<AssistantMessage>\n      | undefined;\n    const emitChunk = throttle\n      ? throttleCallback(() => {\n          controller?.enqueue(message);\n        })\n      : () => {\n          controller?.enqueue(message);\n        };\n    super({\n      start(c) {\n        controller = c;\n      },\n      transform(chunk) {\n        const type = chunk.type;\n        switch (type) {\n          case \"part-start\":\n            message = handlePartStart(message, chunk);\n            break;\n\n          case \"tool-call-args-text-finish\":\n            message = handleToolCallArgsTextFinish(message, chunk);\n            break;\n\n          case \"part-finish\":\n            message = handlePartFinish(message, chunk);\n            break;\n\n          case \"text-delta\":\n            message = handleTextDelta(message, chunk);\n            break;\n          case \"result\":\n            message = handleResult(message, chunk);\n            break;\n          case \"message-finish\":\n            message = handleMessageFinish(message, chunk);\n            break;\n          case \"annotations\":\n            message = handleAnnotations(message, chunk);\n            break;\n          case \"data\":\n            message = handleData(message, chunk);\n            break;\n          case \"step-start\":\n            message = handleStepStart(message, chunk);\n            break;\n          case \"step-finish\":\n            message = handleStepFinish(message, chunk);\n            break;\n          case \"error\":\n            message = handleErrorChunk(message, chunk);\n            onError?.(chunk.error);\n            break;\n          case \"update-state\":\n            message = handleUpdateState(message, chunk);\n            break;\n          default: {\n            const unhandledType: never = type;\n            throw new Error(`Unsupported chunk type: ${unhandledType}`);\n          }\n        }\n        emitChunk();\n      },\n      flush(controller) {\n        if (message.status?.type === \"running\") {\n          // Check if there are any tool calls that require action\n          const requiresAction =\n            message.parts?.some(\n              (part) =>\n                part.type === \"tool-call\" &&\n                (part.state === \"call\" || part.state === \"partial-call\") &&\n                part.result === undefined,\n            ) ?? false;\n          message = handleMessageFinish(message, {\n            type: \"message-finish\",\n            path: [],\n            finishReason: requiresAction ? \"tool-calls\" : \"unknown\",\n            usage: {\n              promptTokens: 0,\n              completionTokens: 0,\n            },\n          });\n          controller.enqueue(message);\n        }\n      },\n    });\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2353, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/accumulators/AssistantMessageStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/accumulators/AssistantMessageStream.ts"],"sourcesContent":["import { AssistantStream } from \"../AssistantStream\";\nimport { AssistantMessage } from \"../utils/types\";\nimport { AssistantMessageAccumulator } from \"./assistant-message-accumulator\";\n\nexport class AssistantMessageStream {\n  constructor(public readonly readable: ReadableStream<AssistantMessage>) {\n    this.readable = readable;\n  }\n\n  static fromAssistantStream(stream: AssistantStream) {\n    return new AssistantMessageStream(\n      stream.pipeThrough(new AssistantMessageAccumulator()),\n    );\n  }\n\n  async unstable_result(): Promise<AssistantMessage> {\n    let last: AssistantMessage | undefined;\n    for await (const chunk of this) {\n      last = chunk;\n    }\n\n    if (!last) {\n      return {\n        role: \"assistant\",\n        status: { type: \"complete\", reason: \"unknown\" },\n        parts: [],\n        content: [],\n        metadata: {\n          unstable_state: null,\n          unstable_data: [],\n          unstable_annotations: [],\n          steps: [],\n          custom: {},\n        },\n      };\n    }\n    return last;\n  }\n\n  [Symbol.asyncIterator]() {\n    const reader = this.readable.getReader();\n    return {\n      async next(): Promise<IteratorResult<AssistantMessage, undefined>> {\n        const { done, value } = await reader.read();\n        return done ? { done: true, value: undefined } : { done: false, value };\n      },\n    };\n  }\n\n  tee(): [AssistantMessageStream, AssistantMessageStream] {\n    const [readable1, readable2] = this.readable.tee();\n    return [\n      new AssistantMessageStream(readable1),\n      new AssistantMessageStream(readable2),\n    ];\n  }\n}\n"],"names":[],"mappings":";;;;AAEA,OAAO,EAAE,2BAA2B,EAAE,2CAAwC;;AAExE,MAAO,sBAAsB;IACL,SAAA;IAA5B,YAA4B,QAA0C,CAAA;QAA1C,IAAA,CAAA,QAAQ,GAAR,QAAQ,CAAkC;QACpE,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC3B,CAAC;IAED,MAAM,CAAC,mBAAmB,CAAC,MAAuB,EAAA;QAChD,OAAO,IAAI,sBAAsB,CAC/B,MAAM,CAAC,WAAW,CAAC,IAAI,yOAA2B,EAAE,CAAC,CACtD,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,eAAe,GAAA;QACnB,IAAI,IAAkC,CAAC;QACvC,IAAI,KAAK,EAAE,MAAM,KAAK,IAAI,IAAI,CAAE,CAAC;YAC/B,IAAI,GAAG,KAAK,CAAC;QACf,CAAC;QAED,IAAI,CAAC,IAAI,EAAE,CAAC;YACV,OAAO;gBACL,IAAI,EAAE,WAAW;gBACjB,MAAM,EAAE;oBAAE,IAAI,EAAE,UAAU;oBAAE,MAAM,EAAE,SAAS;gBAAA,CAAE;gBAC/C,KAAK,EAAE,EAAE;gBACT,OAAO,EAAE,EAAE;gBACX,QAAQ,EAAE;oBACR,cAAc,EAAE,IAAI;oBACpB,aAAa,EAAE,EAAE;oBACjB,oBAAoB,EAAE,EAAE;oBACxB,KAAK,EAAE,EAAE;oBACT,MAAM,EAAE,CAAA,CAAE;iBACX;aACF,CAAC;QACJ,CAAC;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,CAAC,MAAM,CAAC,aAAa,CAAC,GAAA;QACpB,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;QACzC,OAAO;YACL,KAAK,CAAC,IAAI;gBACR,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,CAAC;gBAC5C,OAAO,IAAI,CAAC,CAAC,CAAC;oBAAE,IAAI,EAAE,IAAI;oBAAE,KAAK,EAAE,SAAS;gBAAA,CAAE,CAAC,CAAC,CAAC;oBAAE,IAAI,EAAE,KAAK;oBAAE,KAAK;gBAAA,CAAE,CAAC;YAC1E,CAAC;SACF,CAAC;IACJ,CAAC;IAED,GAAG,GAAA;QACD,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC;QACnD,OAAO;YACL,IAAI,sBAAsB,CAAC,SAAS,CAAC;YACrC,IAAI,sBAAsB,CAAC,SAAS,CAAC;SACtC,CAAC;IACJ,CAAC;CACF"}},
    {"offset": {"line": 2420, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/utils/withPromiseOrValue.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/utils/withPromiseOrValue.ts"],"sourcesContent":["export function withPromiseOrValue<T>(\n  callback: () => T | PromiseLike<T>,\n  thenHandler: (value: T) => PromiseLike<void> | void,\n  catchHandler: (error: unknown) => PromiseLike<void> | void,\n): PromiseLike<void> | void {\n  try {\n    const promiseOrValue = callback();\n    if (\n      typeof promiseOrValue === \"object\" &&\n      promiseOrValue !== null &&\n      \"then\" in promiseOrValue\n    ) {\n      return promiseOrValue.then(thenHandler, catchHandler);\n    } else {\n      thenHandler(promiseOrValue);\n    }\n  } catch (e) {\n    catchHandler(e);\n  }\n}\n"],"names":[],"mappings":";;;;AAAM,SAAU,kBAAkB,CAChC,QAAkC,EAClC,WAAmD,EACnD,YAA0D;IAE1D,IAAI,CAAC;QACH,MAAM,cAAc,GAAG,QAAQ,EAAE,CAAC;QAClC,IACE,OAAO,cAAc,KAAK,QAAQ,IAClC,cAAc,KAAK,IAAI,IACvB,MAAM,IAAI,cAAc,EACxB,CAAC;YACD,OAAO,cAAc,CAAC,IAAI,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;QACxD,CAAC,MAAM,CAAC;YACN,WAAW,CAAC,cAAc,CAAC,CAAC;QAC9B,CAAC;IACH,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;QACX,YAAY,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC;AACH,CAAC"}},
    {"offset": {"line": 2440, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/utils/AsyncIterableStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/utils/AsyncIterableStream.ts"],"sourcesContent":["export type AsyncIterableStream<T> = AsyncIterable<T> & ReadableStream<T>;\n\nasync function* streamGeneratorPolyfill<T>(\n  this: ReadableStream<T>,\n): AsyncIterator<T, undefined, unknown> {\n  const reader = this.getReader();\n  try {\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n      yield value;\n    }\n  } finally {\n    reader.releaseLock();\n  }\n}\n\nexport function asAsyncIterableStream<T>(\n  source: ReadableStream<T>,\n): AsyncIterableStream<T> {\n  (source as AsyncIterableStream<T>)[Symbol.asyncIterator] ??=\n    streamGeneratorPolyfill;\n  return source as AsyncIterableStream<T>;\n}\n"],"names":[],"mappings":";;;;AAEA,KAAK,SAAS,CAAC,CAAC,uBAAuB;IAGrC,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;IAChC,IAAI,CAAC;QACH,MAAO,IAAI,CAAE,CAAC;YACZ,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,CAAC;YAC5C,IAAI,IAAI,EAAE,MAAM;YAChB,MAAM,KAAK,CAAC;QACd,CAAC;IACH,CAAC,QAAS,CAAC;QACT,MAAM,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;AACH,CAAC;AAEK,SAAU,qBAAqB,CACnC,MAAyB;IAExB,MAAiC,CAAC,MAAM,CAAC,aAAa,CAAC,KACtD,uBAAuB,CAAC;IAC1B,OAAO,MAAgC,CAAC;AAC1C,CAAC"}},
    {"offset": {"line": 2464, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/tool/ToolCallReader.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/tool/ToolCallReader.ts"],"sourcesContent":["import { promiseWithResolvers } from \"../../utils/promiseWithResolvers\";\nimport {\n  parsePartialJsonObject,\n  getPartialJsonObjectFieldState,\n} from \"../../utils/json/parse-partial-json-object\";\nimport {\n  ToolCallArgsReader,\n  ToolCallReader,\n  ToolCallResponseReader,\n} from \"./tool-types\";\nimport { DeepPartial, TypeAtPath, TypePath } from \"./type-path-utils\";\nimport { ToolResponse } from \"./ToolResponse\";\nimport {\n  asAsyncIterableStream,\n  AsyncIterableStream,\n  ReadonlyJSONObject,\n  ReadonlyJSONValue,\n} from \"../../utils\";\n\n// TODO: remove dispose\n\nfunction getField<T>(obj: T, fieldPath: (string | number)[]): unknown {\n  let current: unknown = obj;\n  for (const key of fieldPath) {\n    if (current === undefined || current === null) {\n      return undefined;\n    }\n    current = current[key as keyof typeof current];\n  }\n  return current;\n}\n\ninterface Handle {\n  update(args: unknown): void;\n  dispose(): void;\n}\n\nclass GetHandle<T, TValue> implements Handle {\n  private resolve: (value: TValue) => void;\n  private reject: (reason: unknown) => void;\n  private disposed = false;\n  private fieldPath: (string | number)[];\n\n  constructor(\n    resolve: (value: TValue) => void,\n    reject: (reason: unknown) => void,\n    fieldPath: (string | number)[],\n  ) {\n    this.resolve = resolve;\n    this.reject = reject;\n    this.fieldPath = fieldPath;\n  }\n\n  update(args: unknown): void {\n    if (this.disposed) return;\n\n    try {\n      // Check if the field is complete\n      if (\n        getPartialJsonObjectFieldState(\n          args as Record<string, unknown>,\n          this.fieldPath,\n        ) === \"complete\"\n      ) {\n        const value = getField(args as T, this.fieldPath);\n        if (value !== undefined) {\n          this.resolve(value as TValue);\n          this.dispose();\n        }\n      }\n    } catch (e) {\n      this.reject(e);\n      this.dispose();\n    }\n  }\n\n  dispose(): void {\n    this.disposed = true;\n  }\n}\n\nclass StreamValuesHandle<T> implements Handle {\n  private controller: ReadableStreamDefaultController<unknown>;\n  private disposed = false;\n  private fieldPath: (string | number)[];\n\n  constructor(\n    controller: ReadableStreamDefaultController<unknown>,\n    fieldPath: (string | number)[],\n  ) {\n    this.controller = controller;\n    this.fieldPath = fieldPath;\n  }\n\n  update(args: unknown): void {\n    if (this.disposed) return;\n\n    try {\n      const value = getField(args as T, this.fieldPath);\n\n      if (value !== undefined) {\n        this.controller.enqueue(value);\n      }\n\n      // Check if the field is complete, if so close the stream\n      if (\n        getPartialJsonObjectFieldState(\n          args as Record<string, unknown>,\n          this.fieldPath,\n        ) === \"complete\"\n      ) {\n        this.controller.close();\n        this.dispose();\n      }\n    } catch (e) {\n      this.controller.error(e);\n      this.dispose();\n    }\n  }\n\n  dispose(): void {\n    this.disposed = true;\n  }\n}\n\nclass StreamTextHandle<T> implements Handle {\n  private controller: ReadableStreamDefaultController<unknown>;\n  private disposed = false;\n  private fieldPath: (string | number)[];\n  private lastValue: string | undefined = undefined;\n\n  constructor(\n    controller: ReadableStreamDefaultController<unknown>,\n    fieldPath: (string | number)[],\n  ) {\n    this.controller = controller;\n    this.fieldPath = fieldPath;\n  }\n\n  update(args: unknown): void {\n    if (this.disposed) return;\n\n    try {\n      const value = getField(args as T, this.fieldPath);\n\n      if (value !== undefined && typeof value === \"string\") {\n        const delta = value.substring(this.lastValue?.length || 0);\n        this.lastValue = value;\n        this.controller.enqueue(delta);\n      }\n\n      // Check if the field is complete, if so close the stream\n      if (\n        getPartialJsonObjectFieldState(\n          args as Record<string, unknown>,\n          this.fieldPath,\n        ) === \"complete\"\n      ) {\n        this.controller.close();\n        this.dispose();\n      }\n    } catch (e) {\n      this.controller.error(e);\n      this.dispose();\n    }\n  }\n\n  dispose(): void {\n    this.disposed = true;\n  }\n}\n\nclass ForEachHandle<T> implements Handle {\n  private controller: ReadableStreamDefaultController<unknown>;\n  private disposed = false;\n  private fieldPath: (string | number)[];\n  private processedIndexes = new Set<number>();\n\n  constructor(\n    controller: ReadableStreamDefaultController<unknown>,\n    fieldPath: (string | number)[],\n  ) {\n    this.controller = controller;\n    this.fieldPath = fieldPath;\n  }\n\n  update(args: unknown): void {\n    if (this.disposed) return;\n\n    try {\n      const array = getField(args as T, this.fieldPath);\n\n      if (!Array.isArray(array)) {\n        return;\n      }\n\n      // Check each array element and emit completed ones that haven't been processed\n      for (let i = 0; i < array.length; i++) {\n        if (!this.processedIndexes.has(i)) {\n          const elementPath = [...this.fieldPath, i];\n          if (\n            getPartialJsonObjectFieldState(\n              args as Record<string, unknown>,\n              elementPath,\n            ) === \"complete\"\n          ) {\n            this.controller.enqueue(array[i]);\n            this.processedIndexes.add(i);\n          }\n        }\n      }\n\n      // Check if the entire array is complete\n      if (\n        getPartialJsonObjectFieldState(\n          args as Record<string, unknown>,\n          this.fieldPath,\n        ) === \"complete\"\n      ) {\n        this.controller.close();\n        this.dispose();\n      }\n    } catch (e) {\n      this.controller.error(e);\n      this.dispose();\n    }\n  }\n\n  dispose(): void {\n    this.disposed = true;\n  }\n}\n\n// Implementation of ToolCallReader that uses stream of partial JSON\nexport class ToolCallArgsReaderImpl<T extends ReadonlyJSONObject>\n  implements ToolCallArgsReader<T>\n{\n  private argTextDeltas: ReadableStream<string>;\n  private handles: Set<Handle> = new Set();\n  private args: unknown = parsePartialJsonObject(\"\");\n\n  constructor(argTextDeltas: ReadableStream<string>) {\n    this.argTextDeltas = argTextDeltas;\n    this.processStream();\n  }\n\n  private async processStream(): Promise<void> {\n    try {\n      let accumulatedText = \"\";\n      const reader = this.argTextDeltas.getReader();\n\n      while (true) {\n        const { value, done } = await reader.read();\n        if (done) break;\n\n        accumulatedText += value;\n        const parsedArgs = parsePartialJsonObject(accumulatedText);\n\n        if (parsedArgs !== undefined) {\n          this.args = parsedArgs;\n          // Notify all handles of the updated args\n          for (const handle of this.handles) {\n            handle.update(parsedArgs);\n          }\n        }\n      }\n    } catch (error) {\n      console.error(\"Error processing argument stream:\", error);\n      // Notify handles of the error\n      for (const handle of this.handles) {\n        handle.dispose();\n      }\n    }\n  }\n\n  get<PathT extends TypePath<T>>(\n    ...fieldPath: PathT\n  ): Promise<TypeAtPath<T, PathT>> {\n    return new Promise<TypeAtPath<T, PathT>>((resolve, reject) => {\n      const handle = new GetHandle<T, TypeAtPath<T, PathT>>(\n        resolve,\n        reject,\n        fieldPath,\n      );\n\n      // Check if the field is already complete in current args\n      if (\n        this.args &&\n        getPartialJsonObjectFieldState(\n          this.args as Record<string, unknown>,\n          fieldPath,\n        ) === \"complete\"\n      ) {\n        const value = getField(this.args as T, fieldPath);\n        if (value !== undefined) {\n          resolve(value as TypeAtPath<T, PathT>);\n          return;\n        }\n      }\n\n      this.handles.add(handle);\n      handle.update(this.args);\n    });\n  }\n\n  streamValues<PathT extends TypePath<T>>(\n    ...fieldPath: PathT\n  ): AsyncIterableStream<DeepPartial<TypeAtPath<T, PathT>>> {\n    // Use a type assertion to convert the complex TypePath to a simple array\n    const simplePath = fieldPath as unknown as (string | number)[];\n\n    const stream = new ReadableStream<DeepPartial<TypeAtPath<T, PathT>>>({\n      start: (controller) => {\n        const handle = new StreamValuesHandle<T>(controller, simplePath);\n        this.handles.add(handle);\n\n        // Check current args immediately\n        handle.update(this.args);\n      },\n      cancel: () => {\n        // Find and dispose the corresponding handle\n        for (const handle of this.handles) {\n          if (handle instanceof StreamValuesHandle) {\n            handle.dispose();\n            this.handles.delete(handle);\n            break;\n          }\n        }\n      },\n    });\n\n    return asAsyncIterableStream(stream) as any;\n  }\n\n  streamText<PathT extends TypePath<T>>(\n    ...fieldPath: PathT\n  ): TypeAtPath<T, PathT> extends string & infer U\n    ? AsyncIterableStream<U>\n    : never {\n    // Use a type assertion to convert the complex TypePath to a simple array\n    const simplePath = fieldPath as unknown as (string | number)[];\n\n    const stream = new ReadableStream<unknown>({\n      start: (controller) => {\n        const handle = new StreamTextHandle<T>(controller, simplePath);\n        this.handles.add(handle);\n\n        // Check current args immediately\n        handle.update(this.args);\n      },\n      cancel: () => {\n        // Find and dispose the corresponding handle\n        for (const handle of this.handles) {\n          if (handle instanceof StreamTextHandle) {\n            handle.dispose();\n            this.handles.delete(handle);\n            break;\n          }\n        }\n      },\n    });\n\n    return asAsyncIterableStream(stream) as any;\n  }\n\n  forEach<PathT extends TypePath<T>>(\n    ...fieldPath: PathT\n  ): TypeAtPath<T, PathT> extends Array<infer U>\n    ? AsyncIterableStream<U>\n    : never {\n    // Use a type assertion to convert the complex TypePath to a simple array\n    const simplePath = fieldPath as unknown as (string | number)[];\n\n    const stream = new ReadableStream<unknown>({\n      start: (controller) => {\n        const handle = new ForEachHandle<T>(controller, simplePath);\n        this.handles.add(handle);\n\n        // Check current args immediately\n        handle.update(this.args);\n      },\n      cancel: () => {\n        // Find and dispose the corresponding handle\n        for (const handle of this.handles) {\n          if (handle instanceof ForEachHandle) {\n            handle.dispose();\n            this.handles.delete(handle);\n            break;\n          }\n        }\n      },\n    });\n\n    return asAsyncIterableStream(stream) as any;\n  }\n}\n\nexport class ToolCallResponseReaderImpl<TResult extends ReadonlyJSONValue>\n  implements ToolCallResponseReader<TResult>\n{\n  constructor(private readonly promise: Promise<ToolResponse<TResult>>) {}\n\n  public get() {\n    return this.promise;\n  }\n}\n\nexport class ToolCallReaderImpl<\n  TArgs extends ReadonlyJSONObject,\n  TResult extends ReadonlyJSONValue,\n> implements ToolCallReader<TArgs, TResult>\n{\n  public readonly args: ToolCallArgsReaderImpl<TArgs>;\n  public readonly response: ToolCallResponseReaderImpl<TResult>;\n  private readonly writable: WritableStream<string>;\n  private readonly resolve: (value: ToolResponse<TResult>) => void;\n\n  public argsText: string = \"\";\n\n  constructor() {\n    const stream = new TransformStream<string, string>();\n    this.writable = stream.writable;\n    this.args = new ToolCallArgsReaderImpl<TArgs>(stream.readable);\n\n    const { promise, resolve } = promiseWithResolvers<ToolResponse<TResult>>();\n    this.resolve = resolve;\n    this.response = new ToolCallResponseReaderImpl<TResult>(promise);\n  }\n\n  async appendArgsTextDelta(text: string): Promise<void> {\n    const writer = this.writable.getWriter();\n    try {\n      await writer.write(text);\n    } catch (err) {\n      console.warn(err);\n    } finally {\n      writer.releaseLock();\n    }\n\n    this.argsText += text;\n  }\n\n  setResponse(value: ToolResponse<TResult>): void {\n    this.resolve(value);\n  }\n\n  result = {\n    get: async () => {\n      const response = await this.response.get();\n      return response.result;\n    },\n  };\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,OAAO,EAAE,oBAAoB,EAAE,4CAAyC;AACxE,OAAO,EACL,sBAAsB,EACtB,8BAA8B,GAC/B,sDAAmD;AAQpD,OAAO,EACL,qBAAqB,GAItB,uBAAoB;;;;AAErB,uBAAuB;AAEvB,SAAS,QAAQ,CAAI,GAAM,EAAE,SAA8B;IACzD,IAAI,OAAO,GAAY,GAAG,CAAC;IAC3B,KAAK,MAAM,GAAG,IAAI,SAAS,CAAE,CAAC;QAC5B,IAAI,OAAO,KAAK,SAAS,IAAI,OAAO,KAAK,IAAI,EAAE,CAAC;YAC9C,OAAO,SAAS,CAAC;QACnB,CAAC;QACD,OAAO,GAAG,OAAO,CAAC,GAA2B,CAAC,CAAC;IACjD,CAAC;IACD,OAAO,OAAO,CAAC;AACjB,CAAC;AAOD,MAAM,SAAS;IACL,OAAO,CAA0B;IACjC,MAAM,CAA4B;IAClC,QAAQ,GAAG,KAAK,CAAC;IACjB,SAAS,CAAsB;IAEvC,YACE,OAAgC,EAChC,MAAiC,EACjC,SAA8B,CAAA;QAE9B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAED,MAAM,CAAC,IAAa,EAAA;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE,OAAO;QAE1B,IAAI,CAAC;YACH,iCAAiC;YACjC,QACE,oOAA8B,EAC5B,IAA+B,EAC/B,IAAI,CAAC,SAAS,CACf,KAAK,UAAU,EAChB,CAAC;gBACD,MAAM,KAAK,GAAG,QAAQ,CAAC,IAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;gBAClD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;oBACxB,IAAI,CAAC,OAAO,CAAC,KAAe,CAAC,CAAC;oBAC9B,IAAI,CAAC,OAAO,EAAE,CAAC;gBACjB,CAAC;YACH,CAAC;QACH,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YACX,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACf,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;IACH,CAAC;IAED,OAAO,GAAA;QACL,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IACvB,CAAC;CACF;AAED,MAAM,kBAAkB;IACd,UAAU,CAA2C;IACrD,QAAQ,GAAG,KAAK,CAAC;IACjB,SAAS,CAAsB;IAEvC,YACE,UAAoD,EACpD,SAA8B,CAAA;QAE9B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAED,MAAM,CAAC,IAAa,EAAA;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE,OAAO;QAE1B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,QAAQ,CAAC,IAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAElD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;gBACxB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC;YAED,yDAAyD;YACzD,QACE,oOAA8B,EAC5B,IAA+B,EAC/B,IAAI,CAAC,SAAS,CACf,KAAK,UAAU,EAChB,CAAC;gBACD,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;gBACxB,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC;QACH,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;IACH,CAAC;IAED,OAAO,GAAA;QACL,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IACvB,CAAC;CACF;AAED,MAAM,gBAAgB;IACZ,UAAU,CAA2C;IACrD,QAAQ,GAAG,KAAK,CAAC;IACjB,SAAS,CAAsB;IAC/B,SAAS,GAAuB,SAAS,CAAC;IAElD,YACE,UAAoD,EACpD,SAA8B,CAAA;QAE9B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAED,MAAM,CAAC,IAAa,EAAA;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE,OAAO;QAE1B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,QAAQ,CAAC,IAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAElD,IAAI,KAAK,KAAK,SAAS,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;gBACrD,MAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,IAAI,CAAC,CAAC,CAAC;gBAC3D,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC;YAED,yDAAyD;YACzD,QACE,oOAA8B,EAC5B,IAA+B,EAC/B,IAAI,CAAC,SAAS,CACf,KAAK,UAAU,EAChB,CAAC;gBACD,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;gBACxB,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC;QACH,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;IACH,CAAC;IAED,OAAO,GAAA;QACL,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IACvB,CAAC;CACF;AAED,MAAM,aAAa;IACT,UAAU,CAA2C;IACrD,QAAQ,GAAG,KAAK,CAAC;IACjB,SAAS,CAAsB;IAC/B,gBAAgB,GAAG,IAAI,GAAG,EAAU,CAAC;IAE7C,YACE,UAAoD,EACpD,SAA8B,CAAA;QAE9B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAED,MAAM,CAAC,IAAa,EAAA;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE,OAAO;QAE1B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,QAAQ,CAAC,IAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAElD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;gBAC1B,OAAO;YACT,CAAC;YAED,+EAA+E;YAC/E,IAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,CAAE,CAAC;gBACtC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;oBAClC,MAAM,WAAW,GAAG,CAAC;2BAAG,IAAI,CAAC,SAAS;wBAAE,CAAC;qBAAC,CAAC;oBAC3C,QACE,oOAA8B,EAC5B,IAA+B,EAC/B,WAAW,CACZ,KAAK,UAAU,EAChB,CAAC;wBACD,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;wBAClC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;oBAC/B,CAAC;gBACH,CAAC;YACH,CAAC;YAED,wCAAwC;YACxC,QACE,oOAA8B,EAC5B,IAA+B,EAC/B,IAAI,CAAC,SAAS,CACf,KAAK,UAAU,EAChB,CAAC;gBACD,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;gBACxB,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC;QACH,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;IACH,CAAC;IAED,OAAO,GAAA;QACL,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IACvB,CAAC;CACF;AAGK,MAAO,sBAAsB;IAGzB,aAAa,CAAyB;IACtC,OAAO,GAAgB,IAAI,GAAG,EAAE,CAAC;IACjC,IAAI,OAAY,4NAAsB,EAAC,EAAE,CAAC,CAAC;IAEnD,YAAY,aAAqC,CAAA;QAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEO,KAAK,CAAC,aAAa,GAAA;QACzB,IAAI,CAAC;YACH,IAAI,eAAe,GAAG,EAAE,CAAC;YACzB,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;YAE9C,MAAO,IAAI,CAAE,CAAC;gBACZ,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,CAAC;gBAC5C,IAAI,IAAI,EAAE,MAAM;gBAEhB,eAAe,IAAI,KAAK,CAAC;gBACzB,MAAM,UAAU,OAAG,4NAAsB,EAAC,eAAe,CAAC,CAAC;gBAE3D,IAAI,UAAU,KAAK,SAAS,EAAE,CAAC;oBAC7B,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC;oBACvB,yCAAyC;oBACzC,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;wBAClC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;oBAC5B,CAAC;gBACH,CAAC;YACH,CAAC;QACH,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC;YACf,OAAO,CAAC,KAAK,CAAC,mCAAmC,EAAE,KAAK,CAAC,CAAC;YAC1D,8BAA8B;YAC9B,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;gBAClC,MAAM,CAAC,OAAO,EAAE,CAAC;YACnB,CAAC;QACH,CAAC;IACH,CAAC;IAED,GAAG,CACD,GAAG,SAAgB,EAAA;QAEnB,OAAO,IAAI,OAAO,CAAuB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YAC3D,MAAM,MAAM,GAAG,IAAI,SAAS,CAC1B,OAAO,EACP,MAAM,EACN,SAAS,CACV,CAAC;YAEF,yDAAyD;YACzD,IACE,IAAI,CAAC,IAAI,QACT,oOAA8B,EAC5B,IAAI,CAAC,IAA+B,EACpC,SAAS,CACV,KAAK,UAAU,EAChB,CAAC;gBACD,MAAM,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAS,EAAE,SAAS,CAAC,CAAC;gBAClD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;oBACxB,OAAO,CAAC,KAA6B,CAAC,CAAC;oBACvC,OAAO;gBACT,CAAC;YACH,CAAC;YAED,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACzB,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,YAAY,CACV,GAAG,SAAgB,EAAA;QAEnB,yEAAyE;QACzE,MAAM,UAAU,GAAG,SAA2C,CAAC;QAE/D,MAAM,MAAM,GAAG,IAAI,cAAc,CAAoC;YACnE,KAAK,EAAE,CAAC,UAAU,EAAE,EAAE;gBACpB,MAAM,MAAM,GAAG,IAAI,kBAAkB,CAAI,UAAU,EAAE,UAAU,CAAC,CAAC;gBACjE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAEzB,iCAAiC;gBACjC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;YACD,MAAM,EAAE,GAAG,EAAE;gBACX,4CAA4C;gBAC5C,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;oBAClC,IAAI,MAAM,YAAY,kBAAkB,EAAE,CAAC;wBACzC,MAAM,CAAC,OAAO,EAAE,CAAC;wBACjB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC5B,MAAM;oBACR,CAAC;gBACH,CAAC;YACH,CAAC;SACF,CAAC,CAAC;QAEH,WAAO,oMAAqB,EAAC,MAAM,CAAQ,CAAC;IAC9C,CAAC;IAED,UAAU,CACR,GAAG,SAAgB,EAAA;QAInB,yEAAyE;QACzE,MAAM,UAAU,GAAG,SAA2C,CAAC;QAE/D,MAAM,MAAM,GAAG,IAAI,cAAc,CAAU;YACzC,KAAK,EAAE,CAAC,UAAU,EAAE,EAAE;gBACpB,MAAM,MAAM,GAAG,IAAI,gBAAgB,CAAI,UAAU,EAAE,UAAU,CAAC,CAAC;gBAC/D,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAEzB,iCAAiC;gBACjC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;YACD,MAAM,EAAE,GAAG,EAAE;gBACX,4CAA4C;gBAC5C,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;oBAClC,IAAI,MAAM,YAAY,gBAAgB,EAAE,CAAC;wBACvC,MAAM,CAAC,OAAO,EAAE,CAAC;wBACjB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC5B,MAAM;oBACR,CAAC;gBACH,CAAC;YACH,CAAC;SACF,CAAC,CAAC;QAEH,WAAO,oMAAqB,EAAC,MAAM,CAAQ,CAAC;IAC9C,CAAC;IAED,OAAO,CACL,GAAG,SAAgB,EAAA;QAInB,yEAAyE;QACzE,MAAM,UAAU,GAAG,SAA2C,CAAC;QAE/D,MAAM,MAAM,GAAG,IAAI,cAAc,CAAU;YACzC,KAAK,EAAE,CAAC,UAAU,EAAE,EAAE;gBACpB,MAAM,MAAM,GAAG,IAAI,aAAa,CAAI,UAAU,EAAE,UAAU,CAAC,CAAC;gBAC5D,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAEzB,iCAAiC;gBACjC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;YACD,MAAM,EAAE,GAAG,EAAE;gBACX,4CAA4C;gBAC5C,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;oBAClC,IAAI,MAAM,YAAY,aAAa,EAAE,CAAC;wBACpC,MAAM,CAAC,OAAO,EAAE,CAAC;wBACjB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC5B,MAAM;oBACR,CAAC;gBACH,CAAC;YACH,CAAC;SACF,CAAC,CAAC;QAEH,WAAO,oMAAqB,EAAC,MAAM,CAAQ,CAAC;IAC9C,CAAC;CACF;AAEK,MAAO,0BAA0B;IAGR,QAAA;IAA7B,YAA6B,OAAuC,CAAA;QAAvC,IAAA,CAAA,OAAO,GAAP,OAAO,CAAgC;IAAG,CAAC;IAEjE,GAAG,GAAA;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;CACF;AAEK,MAAO,kBAAkB;IAKb,IAAI,CAAgC;IACpC,QAAQ,CAAsC;IAC7C,QAAQ,CAAyB;IACjC,OAAO,CAAyC;IAE1D,QAAQ,GAAW,EAAE,CAAC;IAE7B,aAAA;QACE,MAAM,MAAM,GAAG,IAAI,eAAe,EAAkB,CAAC;QACrD,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;QAChC,IAAI,CAAC,IAAI,GAAG,IAAI,sBAAsB,CAAQ,MAAM,CAAC,QAAQ,CAAC,CAAC;QAE/D,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,OAAG,oMAAoB,EAAyB,CAAC;QAC3E,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,QAAQ,GAAG,IAAI,0BAA0B,CAAU,OAAO,CAAC,CAAC;IACnE,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,IAAY,EAAA;QACpC,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;QACzC,IAAI,CAAC;YACH,MAAM,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;YACb,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACpB,CAAC,QAAS,CAAC;YACT,MAAM,CAAC,WAAW,EAAE,CAAC;QACvB,CAAC;QAED,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC;IACxB,CAAC;IAED,WAAW,CAAC,KAA4B,EAAA;QACtC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IACtB,CAAC;IAED,MAAM,GAAG;QACP,GAAG,EAAE,KAAK,IAAI,EAAE;YACd,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC;YAC3C,OAAO,QAAQ,CAAC,MAAM,CAAC;QACzB,CAAC;KACF,CAAC;CACH"}},
    {"offset": {"line": 2789, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/tool/ToolExecutionStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/tool/ToolExecutionStream.ts"],"sourcesContent":["import sjson from \"secure-json-parse\";\nimport { AssistantStreamChunk } from \"../AssistantStreamChunk\";\nimport {\n  AssistantMetaStreamChunk,\n  AssistantMetaTransformStream,\n} from \"../utils/stream/AssistantMetaTransformStream\";\nimport { PipeableTransformStream } from \"../utils/stream/PipeableTransformStream\";\nimport {\n  ReadonlyJSONObject,\n  ReadonlyJSONValue,\n} from \"../../utils/json/json-value\";\nimport { ToolResponse } from \"./ToolResponse\";\nimport { withPromiseOrValue } from \"../utils/withPromiseOrValue\";\nimport { ToolCallReaderImpl } from \"./ToolCallReader\";\nimport { ToolCallReader } from \"./tool-types\";\n\ntype ToolCallback = (toolCall: {\n  toolCallId: string;\n  toolName: string;\n  args: ReadonlyJSONObject;\n}) =>\n  | Promise<ToolResponse<ReadonlyJSONValue>>\n  | ToolResponse<ReadonlyJSONValue>\n  | undefined;\n\ntype ToolStreamCallback = <\n  TArgs extends ReadonlyJSONObject = ReadonlyJSONObject,\n  TResult extends ReadonlyJSONValue = ReadonlyJSONValue,\n>(toolCall: {\n  reader: ToolCallReader<TArgs, TResult>;\n  toolCallId: string;\n  toolName: string;\n}) => void;\n\ntype ToolExecutionOptions = {\n  execute: ToolCallback;\n  streamCall: ToolStreamCallback;\n  onExecutionStart?:\n    | ((toolCallId: string, toolName: string) => void)\n    | undefined;\n  onExecutionEnd?: ((toolCallId: string, toolName: string) => void) | undefined;\n};\n\nexport class ToolExecutionStream extends PipeableTransformStream<\n  AssistantStreamChunk,\n  AssistantStreamChunk\n> {\n  constructor(options: ToolExecutionOptions) {\n    const toolCallPromises = new Map<string, PromiseLike<void>>();\n    const toolCallControllers = new Map<\n      string,\n      ToolCallReaderImpl<ReadonlyJSONObject, ReadonlyJSONValue>\n    >();\n\n    super((readable) => {\n      const transform = new TransformStream<\n        AssistantMetaStreamChunk,\n        AssistantStreamChunk\n      >({\n        transform(chunk, controller) {\n          // forward everything\n          if (chunk.type !== \"part-finish\" || chunk.meta.type !== \"tool-call\") {\n            controller.enqueue(chunk);\n          }\n\n          const type = chunk.type;\n\n          switch (type) {\n            case \"part-start\":\n              if (chunk.part.type === \"tool-call\") {\n                const reader = new ToolCallReaderImpl<\n                  ReadonlyJSONObject,\n                  ReadonlyJSONValue\n                >();\n                toolCallControllers.set(chunk.part.toolCallId, reader);\n\n                options.streamCall({\n                  reader,\n                  toolCallId: chunk.part.toolCallId,\n                  toolName: chunk.part.toolName,\n                });\n              }\n              break;\n            case \"text-delta\": {\n              if (chunk.meta.type === \"tool-call\") {\n                const toolCallId = chunk.meta.toolCallId;\n\n                const controller = toolCallControllers.get(toolCallId);\n                if (!controller)\n                  throw new Error(\"No controller found for tool call\");\n                controller.appendArgsTextDelta(chunk.textDelta);\n              }\n              break;\n            }\n            case \"result\": {\n              if (chunk.meta.type !== \"tool-call\") break;\n\n              const { toolCallId } = chunk.meta;\n              const controller = toolCallControllers.get(toolCallId);\n              if (!controller)\n                throw new Error(\"No controller found for tool call\");\n              controller.setResponse(\n                new ToolResponse({\n                  result: chunk.result,\n                  artifact: chunk.artifact,\n                  isError: chunk.isError,\n                }),\n              );\n              break;\n            }\n            case \"tool-call-args-text-finish\": {\n              if (chunk.meta.type !== \"tool-call\") break;\n\n              const { toolCallId, toolName } = chunk.meta;\n              const streamController = toolCallControllers.get(toolCallId)!;\n              if (!streamController)\n                throw new Error(\"No controller found for tool call\");\n\n              let isExecuting = false;\n              const promise = withPromiseOrValue(\n                () => {\n                  let args;\n                  try {\n                    args = sjson.parse(streamController.argsText);\n                  } catch (e) {\n                    throw new Error(\n                      `Function parameter parsing failed. ${JSON.stringify((e as Error).message)}`,\n                    );\n                  }\n\n                  const executeResult = options.execute({\n                    toolCallId,\n                    toolName,\n                    args,\n                  });\n\n                  // Only mark as executing if the tool has frontend execution\n                  if (executeResult !== undefined) {\n                    isExecuting = true;\n                    options.onExecutionStart?.(toolCallId, toolName);\n                  }\n\n                  return executeResult;\n                },\n                (c) => {\n                  if (isExecuting) {\n                    options.onExecutionEnd?.(toolCallId, toolName);\n                  }\n\n                  if (c === undefined) return;\n\n                  // TODO how to handle new ToolResult({ result: undefined })?\n                  const result = new ToolResponse({\n                    artifact: c.artifact,\n                    result: c.result,\n                    isError: c.isError,\n                  });\n                  streamController.setResponse(result);\n                  controller.enqueue({\n                    type: \"result\",\n                    path: chunk.path,\n                    ...result,\n                  });\n                },\n                (e) => {\n                  if (isExecuting) {\n                    options.onExecutionEnd?.(toolCallId, toolName);\n                  }\n\n                  const result = new ToolResponse({\n                    result: String(e),\n                    isError: true,\n                  });\n\n                  streamController.setResponse(result);\n                  controller.enqueue({\n                    type: \"result\",\n                    path: chunk.path,\n                    ...result,\n                  });\n                },\n              );\n              if (promise) {\n                toolCallPromises.set(toolCallId, promise);\n              }\n              break;\n            }\n\n            case \"part-finish\": {\n              if (chunk.meta.type !== \"tool-call\") break;\n\n              const { toolCallId } = chunk.meta;\n              const toolCallPromise = toolCallPromises.get(toolCallId);\n              if (toolCallPromise) {\n                toolCallPromise.then(() => {\n                  toolCallPromises.delete(toolCallId);\n                  toolCallControllers.delete(toolCallId);\n\n                  controller.enqueue(chunk);\n                });\n              } else {\n                controller.enqueue(chunk);\n              }\n            }\n          }\n        },\n        async flush() {\n          await Promise.all(toolCallPromises.values());\n        },\n      });\n\n      return readable\n        .pipeThrough(new AssistantMetaTransformStream())\n        .pipeThrough(transform);\n    });\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2943, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/tool/toolResultStream.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/tool/toolResultStream.ts"],"sourcesContent":["import { Tool, ToolCallReader, ToolExecuteFunction } from \"./tool-types\";\nimport { StandardSchemaV1 } from \"@standard-schema/spec\";\nimport { ToolResponse } from \"./ToolResponse\";\nimport { ToolExecutionStream } from \"./ToolExecutionStream\";\nimport { AssistantMessage } from \"../utils/types\";\nimport { ReadonlyJSONObject, ReadonlyJSONValue } from \"../../utils\";\n\nconst isStandardSchemaV1 = (\n  schema: unknown,\n): schema is StandardSchemaV1<unknown> => {\n  return (\n    typeof schema === \"object\" &&\n    schema !== null &&\n    \"~standard\" in schema &&\n    (schema as StandardSchemaV1<unknown>)[\"~standard\"].version === 1\n  );\n};\n\nfunction getToolResponse(\n  tools: Record<string, Tool> | undefined,\n  abortSignal: AbortSignal,\n  toolCall: {\n    toolCallId: string;\n    toolName: string;\n    args: ReadonlyJSONObject;\n  },\n  human: (toolCallId: string, payload: unknown) => Promise<unknown>,\n) {\n  const tool = tools?.[toolCall.toolName];\n  if (!tool || !tool.execute) return undefined;\n\n  const getResult = async (\n    toolExecute: ToolExecuteFunction<ReadonlyJSONObject, unknown>,\n  ): Promise<ToolResponse<ReadonlyJSONValue>> => {\n    // Check if already aborted before starting\n    if (abortSignal.aborted) {\n      return new ToolResponse({\n        result: \"Tool execution was cancelled.\",\n        isError: true,\n      });\n    }\n\n    let executeFn = toolExecute;\n\n    if (isStandardSchemaV1(tool.parameters)) {\n      let result = tool.parameters[\"~standard\"].validate(toolCall.args);\n      if (result instanceof Promise) result = await result;\n\n      if (result.issues) {\n        executeFn =\n          tool.experimental_onSchemaValidationError ??\n          (() => {\n            throw new Error(\n              `Function parameter validation failed. ${JSON.stringify(result.issues)}`,\n            );\n          });\n      }\n    }\n\n    // Create abort promise that resolves after 2 microtasks\n    // This gives tools that handle abort a chance to win the race\n    const abortPromise = new Promise<ToolResponse<ReadonlyJSONValue>>(\n      (resolve) => {\n        const onAbort = () => {\n          queueMicrotask(() => {\n            queueMicrotask(() => {\n              resolve(\n                new ToolResponse({\n                  result: \"Tool execution was cancelled.\",\n                  isError: true,\n                }),\n              );\n            });\n          });\n        };\n        if (abortSignal.aborted) {\n          onAbort();\n        } else {\n          abortSignal.addEventListener(\"abort\", onAbort, { once: true });\n        }\n      },\n    );\n\n    const executePromise = (async () => {\n      const result = (await executeFn(toolCall.args, {\n        toolCallId: toolCall.toolCallId,\n        abortSignal,\n        human: (payload: unknown) => human(toolCall.toolCallId, payload),\n      })) as unknown as ReadonlyJSONValue;\n      return ToolResponse.toResponse(result);\n    })();\n\n    return Promise.race([executePromise, abortPromise]);\n  };\n\n  return getResult(tool.execute);\n}\n\nfunction getToolStreamResponse(\n  tools: Record<string, Tool> | undefined,\n  abortSignal: AbortSignal,\n  reader: ToolCallReader<any, ReadonlyJSONValue>,\n  context: {\n    toolCallId: string;\n    toolName: string;\n  },\n  human: (toolCallId: string, payload: unknown) => Promise<unknown>,\n) {\n  tools?.[context.toolName]?.streamCall?.(reader, {\n    toolCallId: context.toolCallId,\n    abortSignal,\n    human: (payload: unknown) => human(context.toolCallId, payload),\n  });\n}\n\nexport async function unstable_runPendingTools(\n  message: AssistantMessage,\n  tools: Record<string, Tool> | undefined,\n  abortSignal: AbortSignal,\n  human: (toolCallId: string, payload: unknown) => Promise<unknown>,\n) {\n  const toolCallPromises = message.parts\n    .filter((part) => part.type === \"tool-call\")\n    .map(async (part) => {\n      const promiseOrUndefined = getToolResponse(\n        tools,\n        abortSignal,\n        part,\n        human ??\n          (async () => {\n            throw new Error(\n              \"Tool human input is not supported in this context\",\n            );\n          }),\n      );\n      if (promiseOrUndefined) {\n        const result = await promiseOrUndefined;\n        return {\n          toolCallId: part.toolCallId,\n          result,\n        };\n      }\n      return null;\n    });\n\n  const toolCallResults = (await Promise.all(toolCallPromises)).filter(\n    (result) => result !== null,\n  ) as { toolCallId: string; result: ToolResponse<ReadonlyJSONValue> }[];\n\n  if (toolCallResults.length === 0) {\n    return message;\n  }\n\n  const toolCallResultsById = toolCallResults.reduce(\n    (acc, { toolCallId, result }) => {\n      acc[toolCallId] = result;\n      return acc;\n    },\n    {} as Record<string, ToolResponse<ReadonlyJSONValue>>,\n  );\n\n  const updatedParts = message.parts.map((p) => {\n    if (p.type === \"tool-call\") {\n      const toolResponse = toolCallResultsById[p.toolCallId];\n      if (toolResponse) {\n        return {\n          ...p,\n          state: \"result\" as const,\n          ...(toolResponse.artifact !== undefined\n            ? { artifact: toolResponse.artifact }\n            : {}),\n          result: toolResponse.result as ReadonlyJSONValue,\n          isError: toolResponse.isError,\n        };\n      }\n    }\n    return p;\n  });\n\n  return {\n    ...message,\n    parts: updatedParts,\n    content: updatedParts,\n  };\n}\n\nexport type ToolResultStreamOptions = {\n  onExecutionStart?: (toolCallId: string, toolName: string) => void;\n  onExecutionEnd?: (toolCallId: string, toolName: string) => void;\n};\n\nexport function toolResultStream(\n  tools:\n    | Record<string, Tool>\n    | (() => Record<string, Tool> | undefined)\n    | undefined,\n  abortSignal: AbortSignal | (() => AbortSignal),\n  human: (toolCallId: string, payload: unknown) => Promise<unknown>,\n  options?: ToolResultStreamOptions,\n) {\n  const toolsFn = typeof tools === \"function\" ? tools : () => tools;\n  const abortSignalFn =\n    typeof abortSignal === \"function\" ? abortSignal : () => abortSignal;\n  return new ToolExecutionStream({\n    execute: (toolCall) =>\n      getToolResponse(toolsFn(), abortSignalFn(), toolCall, human),\n    streamCall: ({ reader, ...context }) =>\n      getToolStreamResponse(toolsFn(), abortSignalFn(), reader, context, human),\n    onExecutionStart: options?.onExecutionStart,\n    onExecutionEnd: options?.onExecutionEnd,\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3088, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/assistant-stream/dist/core/tool/schema-utils.js","sources":["file:///C:/Users/HORIZON/OneDrive/Desktop/chat-gpt/my-app/node_modules/assistant-stream/src/core/tool/schema-utils.ts"],"sourcesContent":["import type { JSONSchema7 } from \"json-schema\";\nimport type { StandardSchemaV1 } from \"@standard-schema/spec\";\nimport type { Tool } from \"./tool-types\";\n\n/**\n * Type for a tool definition with JSON Schema parameters.\n */\nexport type ToolJSONSchema = {\n  description?: string;\n  parameters: JSONSchema7;\n};\n\nexport type ToToolsJSONSchemaOptions = {\n  /**\n   * Filter to determine which tools to include.\n   * Defaults to excluding disabled tools and backend tools.\n   */\n  filter?: (name: string, tool: Tool) => boolean;\n};\n\nfunction isStandardSchema(schema: unknown): schema is StandardSchemaV1 & {\n  \"~standard\": StandardSchemaV1[\"~standard\"] & { toJSONSchema?: () => unknown };\n} {\n  return (\n    typeof schema === \"object\" &&\n    schema !== null &&\n    \"~standard\" in schema &&\n    typeof (schema as StandardSchemaV1)[\"~standard\"] === \"object\"\n  );\n}\n\nfunction hasToJSONSchemaMethod(\n  schema: unknown,\n): schema is { toJSONSchema: () => unknown } {\n  return (\n    typeof schema === \"object\" &&\n    schema !== null &&\n    \"toJSONSchema\" in schema &&\n    typeof (schema as { toJSONSchema: unknown }).toJSONSchema === \"function\"\n  );\n}\n\nfunction hasToJSONMethod(schema: unknown): schema is { toJSON: () => unknown } {\n  return (\n    typeof schema === \"object\" &&\n    schema !== null &&\n    \"toJSON\" in schema &&\n    typeof (schema as { toJSON: unknown }).toJSON === \"function\"\n  );\n}\n\n/**\n * Converts a schema to JSONSchema7.\n * Supports:\n * - StandardSchemaV1 with ~standard.toJSONSchema (e.g., Zod v4)\n * - Objects with toJSONSchema() method\n * - Objects with toJSON() method\n * - Plain JSONSchema7 objects\n */\nexport function toJSONSchema(\n  schema: StandardSchemaV1 | JSONSchema7,\n): JSONSchema7 {\n  // StandardSchemaV1 with ~standard.toJSONSchema (e.g., Zod v4)\n  if (isStandardSchema(schema)) {\n    const toJSONSchemaMethod = schema[\"~standard\"].toJSONSchema;\n    if (typeof toJSONSchemaMethod === \"function\") {\n      return toJSONSchemaMethod() as JSONSchema7;\n    }\n  }\n\n  // toJSONSchema method on the schema itself\n  if (hasToJSONSchemaMethod(schema)) {\n    return schema.toJSONSchema() as JSONSchema7;\n  }\n\n  // toJSON method on the schema\n  if (hasToJSONMethod(schema)) {\n    return schema.toJSON() as JSONSchema7;\n  }\n\n  // Already a plain JSONSchema7\n  return schema as JSONSchema7;\n}\n\nfunction defaultToolFilter(_name: string, tool: Tool): boolean {\n  return !tool.disabled && tool.type !== \"backend\";\n}\n\n/**\n * Converts a record of tools to a record of tool definitions with JSON Schema parameters.\n * By default, filters out disabled tools and backend tools.\n */\nexport function toToolsJSONSchema(\n  tools: Record<string, Tool> | undefined,\n  options: ToToolsJSONSchemaOptions = {},\n): Record<string, ToolJSONSchema> {\n  if (!tools) return {};\n\n  const filter = options.filter ?? defaultToolFilter;\n\n  return Object.fromEntries(\n    Object.entries(tools)\n      .filter(([name, tool]) => filter(name, tool) && tool.parameters)\n      .map(([name, tool]) => [\n        name,\n        {\n          ...(tool.description && { description: tool.description }),\n          parameters: toJSONSchema(tool.parameters!),\n        },\n      ]),\n  );\n}\n"],"names":[],"mappings":";;;;;;AAoBA,SAAS,gBAAgB,CAAC,MAAe;IAGvC,OAAO,AACL,OAAO,MAAM,KAAK,QAAQ,IAC1B,MAAM,KAAK,IAAI,IACf,WAAW,IAAI,MAAM,IACrB,OAAQ,MAA2B,CAAC,WAAW,CAAC,KAAK,QAAQ,CAC9D,CAAC;AACJ,CAAC;AAED,SAAS,qBAAqB,CAC5B,MAAe;IAEf,OAAO,AACL,OAAO,MAAM,KAAK,QAAQ,IAC1B,MAAM,KAAK,IAAI,IACf,cAAc,IAAI,MAAM,IACxB,OAAQ,MAAoC,CAAC,YAAY,KAAK,UAAU,CACzE,CAAC;AACJ,CAAC;AAED,SAAS,eAAe,CAAC,MAAe;IACtC,OAAO,AACL,OAAO,MAAM,KAAK,QAAQ,IAC1B,MAAM,KAAK,IAAI,IACf,QAAQ,IAAI,MAAM,IAClB,OAAQ,MAA8B,CAAC,MAAM,KAAK,UAAU,CAC7D,CAAC;AACJ,CAAC;AAUK,SAAU,YAAY,CAC1B,MAAsC;IAEtC,8DAA8D;IAC9D,IAAI,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;QAC7B,MAAM,kBAAkB,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC;QAC5D,IAAI,OAAO,kBAAkB,KAAK,UAAU,EAAE,CAAC;YAC7C,OAAO,kBAAkB,EAAiB,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,2CAA2C;IAC3C,IAAI,qBAAqB,CAAC,MAAM,CAAC,EAAE,CAAC;QAClC,OAAO,MAAM,CAAC,YAAY,EAAiB,CAAC;IAC9C,CAAC;IAED,8BAA8B;IAC9B,IAAI,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC;QAC5B,OAAO,MAAM,CAAC,MAAM,EAAiB,CAAC;IACxC,CAAC;IAED,8BAA8B;IAC9B,OAAO,MAAqB,CAAC;AAC/B,CAAC;AAED,SAAS,iBAAiB,CAAC,KAAa,EAAE,IAAU;IAClD,OAAO,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,CAAC;AACnD,CAAC;AAMK,SAAU,iBAAiB,CAC/B,KAAuC,EACvC,UAAoC,CAAA,CAAE;IAEtC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAA,CAAE,CAAC;IAEtB,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,iBAAiB,CAAC;IAEnD,OAAO,MAAM,CAAC,WAAW,CACvB,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAClB,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAG,CAAD,KAAO,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,CAC/D,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAG,CAAD;YACpB,IAAI;YACJ;gBACE,GAAG,AAAC,IAAI,CAAC,WAAW,IAAI;oBAAE,WAAW,EAAE,IAAI,CAAC,WAAW;gBAAA,CAAE,CAAC;gBAC1D,UAAU,EAAE,YAAY,CAAC,IAAI,CAAC,UAAW,CAAC;aAC3C;SACF,CAAC,CACL,CAAC;AACJ,CAAC"}}]
}